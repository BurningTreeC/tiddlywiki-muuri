"use strict";

var ce=Object.defineProperty,ns=Object.defineProperties,rs=Object.getOwnPropertyDescriptor,os=Object.getOwnPropertyDescriptors,as=Object.getOwnPropertyNames,he=Object.getOwnPropertySymbols;var we=Object.prototype.hasOwnProperty,ri=Object.prototype.propertyIsEnumerable;var Pe=(n,t,e)=>t in n?ce(n,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):n[t]=e,M=(n,t)=>{for(var e in t||(t={}))we.call(t,e)&&Pe(n,e,t[e]);if(he)for(var e of he(t))ri.call(t,e)&&Pe(n,e,t[e]);return n},de=(n,t)=>ns(n,os(t));var oi=(n,t)=>{var e={};for(var i in n)we.call(n,i)&&t.indexOf(i)<0&&(e[i]=n[i]);if(n!=null&&he)for(var i of he(n))t.indexOf(i)<0&&ri.call(n,i)&&(e[i]=n[i]);return e};var ls=(n,t)=>{for(var e in t)ce(n,e,{get:t[e],enumerable:!0})},hs=(n,t,e,i)=>{if(t&&typeof t=="object"||typeof t=="function")for(let s of as(t))!we.call(n,s)&&s!==e&&ce(n,s,{get:()=>t[s],enumerable:!(i=rs(t,s))||i.enumerable});return n};var cs=n=>hs(ce({},"__esModule",{value:!0}),n);var me=(n,t,e)=>Pe(n,typeof t!="symbol"?t+"":t,e);var Bs={};ls(Bs,{AUTO_SCROLL_AXIS:()=>ps,AUTO_SCROLL_DIRECTION:()=>ys,Animator:()=>it,AutoScroller:()=>O,Dragger:()=>zt,Grid:()=>ti,Item:()=>Ct,ItemDrag:()=>ot,ItemDragPlaceholder:()=>jt,ItemDragRelease:()=>Qt,ItemLayout:()=>Kt,ItemMigrate:()=>$t,ItemVisibility:()=>Jt,PHASE_READ:()=>v,PHASE_READ_TAIL:()=>lt,PHASE_WRITE:()=>D,Packer:()=>ne,ticker:()=>g});module.exports=cs(Bs);function y(n){return typeof n=="function"}var ds="[native code]";function ai(n){return!!(n&&y(window.Symbol)&&y(window.Symbol.toString)&&window.Symbol(n).toString().indexOf(ds)>-1)}function q(n,t){let e;for(e in t)n.style[e]=t[e]||""}var ms=ai(Element.prototype.animate),it=class{constructor(t){this.element=t||null,this.animation=null,this._finishCallback=null,this._onFinish=this._onFinish.bind(this)}start(t,e,i){if(!this.element)return;let{element:s}=this,{duration:r,easing:a,onFinish:d}=i||{};if(!ms){q(s,e),this._finishCallback=y(d)?d:null,this._onFinish();return}this.animation&&this.animation.cancel(),this.animation=s.animate([M({},t),M({},e)],{duration:r||300,easing:a||"ease"}),this._finishCallback=y(d)?d:null,this.animation.onfinish=this._onFinish,q(s,e)}stop(){!this.element||!this.animation||(this.animation.cancel(),this.animation=this._finishCallback=null)}isAnimating(){return!!this.animation}destroy(){this.element&&(this.stop(),this.element=null)}_onFinish(){let{_finishCallback:t}=this;this.animation=this._finishCallback=null,t&&t()}};var X={ADD:"add",UPDATE:"update",IGNORE:"ignore",THROW:"throw"},st=class{constructor(n={}){me(this,"dedupe");me(this,"getId");me(this,"_events");this.dedupe=n.dedupe||X.ADD,this.getId=n.getId||(()=>Symbol()),this._events=new Map}_getListeners(n){let t=this._events.get(n);return t?t.l||(t.l=[...t.m.values()]):null}on(n,t,e){var a;let i=this._events,s=i.get(n);s||(s={m:new Map,l:null},i.set(n,s));let r=s.m;if(e=e===void 0?this.getId(t):e,r.has(e))switch(this.dedupe){case X.THROW:throw Error("Eventti: duplicate listener id!");case X.IGNORE:return e;case X.UPDATE:s.l=null;break;default:r.delete(e),s.l=null}return r.set(e,t),(a=s.l)==null||a.push(t),e}once(n,t,e){let i=0;return e=e===void 0?this.getId(t):e,this.on(n,((...s)=>{i||(i=1,this.off(n,e),t(...s))}),e)}off(n,t){if(n===void 0){this._events.clear();return}if(t===void 0){this._events.delete(n);return}let e=this._events.get(n);e!=null&&e.m.delete(t)&&(e.l=null,e.m.size||this._events.delete(n))}emit(n,...t){let e=this._getListeners(n);if(e){let i=e.length,s=0;if(t.length)for(;s<i;s++)e[s](...t);else for(;s<i;s++)e[s]()}}listenerCount(n){var t;if(n===void 0){let e=0;return this._events.forEach(i=>{e+=i.m.size}),e}return((t=this._events.get(n))==null?void 0:t.m.size)||0}};var us=class{constructor(n={}){let{phases:t=[],dedupe:e,getId:i}=n;this._phases=t,this._emitter=new st({getId:i,dedupe:e}),this._queue=[],this.tick=this.tick.bind(this),this._getListeners=this._emitter._getListeners.bind(this._emitter)}get phases(){return this._phases}set phases(n){this._phases=n}get dedupe(){return this._emitter.dedupe}set dedupe(n){this._emitter.dedupe=n}get getId(){return this._emitter.getId}set getId(n){this._emitter.getId=n}tick(...n){this._assertEmptyQueue(),this._fillQueue(),this._processQueue(...n)}on(n,t,e){return this._emitter.on(n,t,e)}once(n,t,e){return this._emitter.once(n,t,e)}off(n,t){return this._emitter.off(n,t)}count(n){return this._emitter.listenerCount(n)}_assertEmptyQueue(){if(this._queue.length)throw new Error("Ticker: Can't tick before the previous tick has finished!")}_fillQueue(){let n=this._queue,t=this._phases,e=this._getListeners,i=0,s=t.length,r;for(;i<s;i++)r=e(t[i]),r&&n.push(r);return n}_processQueue(...n){let t=this._queue,e=t.length;if(!e)return;let i=0,s=0,r,a;for(;i<e;i++)for(r=t[i],s=0,a=r.length;s<a;s++)r[s](...n);t.length=0}};function fs(n=60){if(typeof requestAnimationFrame=="function"&&typeof cancelAnimationFrame=="function")return t=>{let e=requestAnimationFrame(t);return()=>cancelAnimationFrame(e)};{let t=1e3/n,e=typeof performance>"u"?()=>Date.now():()=>performance.now();return i=>{let s=setTimeout(()=>i(e()),t);return()=>clearTimeout(s)}}}var li=class extends us{constructor(n={}){let r=n,{paused:t=!1,onDemand:e=!1,requestFrame:i=fs()}=r,s=oi(r,["paused","onDemand","requestFrame"]);super(s),this._paused=t,this._onDemand=e,this._requestFrame=i,this._cancelFrame=null,this._empty=!0,!t&&!e&&this._request()}get phases(){return this._phases}set phases(n){this._phases=n,n.length?(this._empty=!1,this._request()):this._empty=!0}get paused(){return this._paused}set paused(n){this._paused=n,n?this._cancel():this._request()}get onDemand(){return this._onDemand}set onDemand(n){this._onDemand=n,n||this._request()}get requestFrame(){return this._requestFrame}set requestFrame(n){this._requestFrame!==n&&(this._requestFrame=n,this._cancelFrame&&(this._cancel(),this._request()))}tick(...n){if(this._assertEmptyQueue(),this._cancelFrame=null,this._onDemand||this._request(),!this._empty){if(!this._fillQueue().length){this._empty=!0;return}this._onDemand&&this._request(),this._processQueue(...n)}}on(n,t,e){let i=super.on(n,t,e);return this._empty=!1,this._request(),i}once(n,t,e){let i=super.once(n,t,e);return this._empty=!1,this._request(),i}_request(){this._paused||this._cancelFrame||(this._cancelFrame=this._requestFrame(this.tick))}_cancel(){this._cancelFrame&&(this._cancelFrame(),this._cancelFrame=null)}};var v=Symbol(),lt=Symbol(),D=Symbol(),g=new li({phases:[v,lt,D],onDemand:!0});function ue(n,t){return!(n.left+n.width<=t.left||t.left+t.width<=n.left||n.top+n.height<=t.top||t.top+t.height<=n.top)}function hi(n,t){if(!ue(n,t))return 0;var e=Math.min(n.left+n.width,t.left+t.width)-Math.max(n.left,t.left),i=Math.min(n.top+n.height,t.top+t.height)-Math.max(n.top,t.top);return e*i}function Et(n,t){let e=hi(n,t);if(!e)return 0;let i=Math.min(n.width,t.width)*Math.min(n.height,t.height);return e/i*100}var ke=new WeakMap,Nt=null,Ce=!0,_s=1e3,gs=function(){if(Ce){Ce=!0;return}Nt!==null&&(window.clearInterval(Nt),Nt=null),ke=new WeakMap};function x(n,t){if(!t)return"";let e=ke.get(n);return e||(e=window.getComputedStyle(n,null),ke.set(n,e)),Nt?Ce=!1:Nt=window.setInterval(gs,_s),e.getPropertyValue(t)}function C(n,t){return parseFloat(x(n,t))||0}var He={width:0,height:0,left:0,right:0,top:0,bottom:0},ci=M({},He),U={direction:0,threshold:0,distance:0,value:0,maxValue:0,duration:0,speed:0,deltaTime:0,isEnding:!1},R=1,w=2,Vt=4,_i=8,St=R|_i,bt=R|Vt,vt=w|_i,Gt=w|Vt,ps={X:R,Y:w},ys={LEFT:St,RIGHT:bt,UP:vt,DOWN:Gt};function Es(n){let t={left:0,top:0,width:0,height:0},e=n||1;return function(i,s,r,a,d,o,l){return t.left=o-e*.5,t.top=l-e*.5,t.width=e,t.height=e,t}}function Ss(n,t,e){return function(i,s,r){let a=0;if(!r.isEnding)if(r.threshold>0){let l=r.threshold-Math.max(0,r.distance);a=n/r.threshold*l}else a=n;let d=r.speed;if(d===a)return a;let o=a;return d<a?(o=d+t*(r.deltaTime/1e3),Math.min(a,o)):(o=d-e*(r.deltaTime/1e3),Math.max(a,o))}}function Dt(n){return n===window}function di(n){return Dt(n)||n===document.documentElement||n===document.body?window:n}function Xt(n){return Dt(n)?n.pageXOffset:n.scrollLeft}function Yt(n){return Dt(n)?n.pageYOffset:n.scrollTop}function mi(n){return Dt(n)?document.documentElement.scrollWidth-document.documentElement.clientWidth:n.scrollWidth-n.clientWidth}function ui(n){return Dt(n)?document.documentElement.scrollHeight-document.documentElement.clientHeight:n.scrollHeight-n.clientHeight}function fi(n,t={width:0,height:0,left:0,right:0,top:0,bottom:0}){if(Dt(n))t.width=document.documentElement.clientWidth,t.height=document.documentElement.clientHeight,t.left=0,t.right=t.width,t.top=0,t.bottom=t.height;else{let{left:e,top:i}=n.getBoundingClientRect(),s=n.clientLeft||C(n,"border-left-width"),r=n.clientTop||C(n,"border-top-width");t.width=n.clientWidth,t.height=n.clientHeight,t.left=e+s,t.right=t.left+t.width,t.top=i+r,t.bottom=t.top+t.height}return t}function Wt(n){return n.getGrid().settings.dragAutoScroll}function bs(n){let t=n._drag;t&&t._prepareScroll()}function vs(n){if(!n.isActive())return;let t=n._drag;t&&(t._scrollDiffX=t._scrollDiffY=0,n._setTranslate(t._translateX,t._translateY))}function Me(n,t){return Math.min(t/2,n)}function Oe(n,t,e,i){return Math.max(0,e+n*2+i*t-i)/2}var fe=class{constructor(t,e){this._pool=[],this._createObject=t,this._onRelease=e}pick(){return this._pool.pop()||this._createObject()}release(t){this._pool.indexOf(t)===-1&&(this._onRelease&&this._onRelease(t),this._pool.push(t))}reset(){this._pool.length=0}},Ne=class{constructor(){this.element=null,this.requestX=null,this.requestY=null,this.scrollLeft=0,this.scrollTop=0}reset(){this.requestX&&(this.requestX.action=null),this.requestY&&(this.requestY.action=null),this.element=null,this.requestX=null,this.requestY=null,this.scrollLeft=0,this.scrollTop=0}addRequest(t){R&t.direction?(this.requestX&&this.removeRequest(this.requestX),this.requestX=t):(this.requestY&&this.removeRequest(this.requestY),this.requestY=t),t.action=this}removeRequest(t){this.requestX===t?(this.requestX=null,t.action=null):this.requestY===t&&(this.requestY=null,t.action=null)}computeScrollValues(){this.element&&(this.scrollLeft=this.requestX?this.requestX.value:Xt(this.element),this.scrollTop=this.requestY?this.requestY.value:Yt(this.element))}scroll(){this.element&&(this.element.scrollTo?this.element.scrollTo(this.scrollLeft,this.scrollTop):(this.element.scrollLeft=this.scrollLeft,this.element.scrollTop=this.scrollTop))}},Ge=class{constructor(){this.item=null,this.element=null,this.isActive=!1,this.isEnding=!1,this.direction=0,this.value=NaN,this.maxValue=0,this.threshold=0,this.distance=0,this.deltaTime=0,this.speed=0,this.duration=0,this.action=null}reset(){this.isActive&&this.onStop(),this.item=null,this.element=null,this.isActive=!1,this.isEnding=!1,this.direction=0,this.value=NaN,this.maxValue=0,this.threshold=0,this.distance=0,this.deltaTime=0,this.speed=0,this.duration=0,this.action=null}hasReachedEnd(){return Vt&this.direction?this.value>=this.maxValue:this.value<=0}computeCurrentScrollValue(){return this.element?this.value!==this.value?R&this.direction?Xt(this.element):Yt(this.element):Math.max(0,Math.min(this.value,this.maxValue)):0}computeNextScrollValue(){let t=this.speed*(this.deltaTime/1e3),e=Vt&this.direction?this.value+t:this.value-t;return Math.max(0,Math.min(e,this.maxValue))}computeSpeed(){if(!this.item||!this.element)return 0;let t=Wt(this.item).speed;return y(t)?(U.direction=this.direction,U.threshold=this.threshold,U.distance=this.distance,U.value=this.value,U.maxValue=this.maxValue,U.duration=this.duration,U.speed=this.speed,U.deltaTime=this.deltaTime,U.isEnding=this.isEnding,t(this.item,this.element,U)):t}tick(t){return this.isActive||(this.isActive=!0,this.onStart()),this.deltaTime=t,this.value=this.computeCurrentScrollValue(),this.speed=this.computeSpeed(),this.value=this.computeNextScrollValue(),this.duration+=t,this.value}onStart(){if(!this.item||!this.element)return;let{onStart:t}=Wt(this.item);y(t)&&t(this.item,this.element,this.direction)}onStop(){if(!this.item||!this.element)return;let{onStop:t}=Wt(this.item);y(t)&&t(this.item,this.element,this.direction);let e=this.item._drag;e&&e.sort()}},O=class{constructor(){this._id=Symbol(),this._isDestroyed=!1,this._isTicking=!1,this._tickTime=0,this._tickDeltaTime=0,this._items=[],this._actions=[],this._requests={[R]:new Map,[w]:new Map},this._requestOverlapCheck=new Map,this._dragPositions=new Map,this._dragDirections=new Map,this._overlapCheckInterval=150,this._requestPool=new fe(()=>new Ge,t=>t.reset()),this._actionPool=new fe(()=>new Ne,t=>t.reset()),this._readTick=this._readTick.bind(this),this._writeTick=this._writeTick.bind(this)}isDestroyed(){return this._isDestroyed}addItem(t,e,i){if(this._isDestroyed)return;this._items.indexOf(t)===-1&&(this._items.push(t),this._requestOverlapCheck.set(t.id,this._tickTime),this._dragDirections.set(t.id,[0,0]),this._dragPositions.set(t.id,[e,i]),this._isTicking||this._startTicking())}updateItem(t,e,i){if(this._isDestroyed)return;let s=this._dragPositions.get(t.id),r=this._dragDirections.get(t.id);if(!s||!r)return;let a=s[0],d=s[1];r[0]=e>a?bt:e<a?St:r[0]||0,r[1]=i>d?Gt:i<d?vt:r[1]||0,s[0]=e,s[1]=i,this._requestOverlapCheck.set(t.id,this._requestOverlapCheck.get(t.id)||this._tickTime)}removeItem(t){if(this._isDestroyed)return;let e=this._items.indexOf(t);if(e===-1)return;let i=t.id;this._requests[R].get(i)&&(this._cancelItemScroll(t,R),this._requests[R].delete(i)),this._requests[w].get(i)&&(this._cancelItemScroll(t,w),this._requests[w].delete(i)),this._requestOverlapCheck.delete(i),this._dragPositions.delete(i),this._dragDirections.delete(i),this._items.splice(e,1),this._isTicking&&!this._items.length&&this._stopTicking()}isItemScrollingX(t){let e=this._requests[R].get(t.id);return!!(e&&e.isActive)}isItemScrollingY(t){let e=this._requests[w].get(t.id);return!!(e&&e.isActive)}isItemScrolling(t){return this.isItemScrollingX(t)||this.isItemScrollingY(t)}destroy(){if(this._isDestroyed)return;let t=this._items.slice(0),e=0;for(;e<t.length;e++)this.removeItem(t[e]);this._actions.length=0,this._requestPool.reset(),this._actionPool.reset(),this._isDestroyed=!0}_readTick(t){this._isDestroyed||(t&&this._tickTime?(this._tickDeltaTime=t-this._tickTime,this._tickTime=t,this._updateRequests(),this._updateActions()):(this._tickTime=t,this._tickDeltaTime=0))}_writeTick(){this._isDestroyed||(this._applyActions(),g.once(v,this._readTick,this._id),g.once(D,this._writeTick,this._id))}_startTicking(){this._isTicking=!0,g.once(v,this._readTick,this._id),g.once(D,this._writeTick,this._id)}_stopTicking(){this._isTicking=!1,this._tickTime=0,this._tickDeltaTime=0,g.off(v,this._id),g.off(D,this._id)}_getItemHandleRect(t,e,i={width:0,height:0,left:0,right:0,top:0,bottom:0}){let s=t._drag;if(e){let r=s._dragMoveEvent||s._dragStartEvent,a=e(t,s._clientX,s._clientY,t.width,t.height,r.clientX,r.clientY);i.left=a.left,i.top=a.top,i.width=a.width,i.height=a.height}else i.left=s._clientX,i.top=s._clientY,i.width=t.width,i.height=t.height;return i.right=i.left+i.width,i.bottom=i.top+i.height,i}_requestItemScroll(t,e,i,s,r,a,d){let o=this._requests[e],l=o.get(t.id);l?(l.element!==i||l.direction!==s)&&l.reset():l=this._requestPool.pick(),l.item=t,l.element=i,l.direction=s,l.threshold=r,l.distance=a,l.maxValue=d,o.set(t.id,l)}_cancelItemScroll(t,e){let i=this._requests[e],s=i.get(t.id);s&&(s.action&&s.action.removeRequest(s),this._requestPool.release(s),i.delete(t.id))}_checkItemOverlap(t,e,i){let s=Wt(t),{threshold:r,safeZone:a,handle:d,targets:o}=s,l=y(o)?o(t):o;if(!l||!l.length){e&&this._cancelItemScroll(t,R),i&&this._cancelItemScroll(t,w);return}let c=this._dragDirections.get(t.id),h=c&&c[0]||0,u=c&&c[1]||0;if(!h&&!u){e&&this._cancelItemScroll(t,R),i&&this._cancelItemScroll(t,w);return}let m=this._getItemHandleRect(t,d,He),f=null,_=-1/0,b=0,S=0,p=0,E=0,L=0,P=null,I=-1/0,N=0,ei=0,Ae=0,ii=0,si=0,Le=0;for(;Le<l.length;Le++){let yt=l[Le],ni=yt.threshold||r,xe=!!(e&&h&&yt.axis!==w),Re=!!(i&&u&&yt.axis!==R),at=yt.priority||0;if((!xe||at<_)&&(!Re||at<I))continue;let $=di(yt.element||yt),ae=xe?mi($):-1,le=Re?ui($):-1;if(!ae&&!le)continue;let J=fi($,ci),Ot=Et(m,J);if(!(Ot<=0)){if(xe&&at>=_&&ae>0&&(at>_||Ot>S)){let F=0,tt=0,et=Me(ni,J.width),Ht=Oe(et,a,m.width,J.width);h===bt?(F=J.right+Ht-m.right,F<=et&&Xt($)<ae&&(tt=bt)):h===St&&(F=m.left-(J.left-Ht),F<=et&&Xt($)>0&&(tt=St)),tt&&(f=$,_=at,b=et,S=Ot,p=tt,E=F,L=ae)}if(Re&&at>=I&&le>0&&(at>I||Ot>ei)){let F=0,tt=0,et=Me(ni,J.height),Ht=Oe(et,a,m.height,J.height);u===Gt?(F=J.bottom+Ht-m.bottom,F<=et&&Yt($)<le&&(tt=Gt)):u===vt&&(F=m.top-(J.top-Ht),F<=et&&Yt($)>0&&(tt=vt)),tt&&(P=$,I=at,N=et,ei=Ot,Ae=tt,ii=F,si=le)}}}e&&(f&&p?this._requestItemScroll(t,R,f,p,b,E,L):this._cancelItemScroll(t,R)),i&&(P&&Ae?this._requestItemScroll(t,w,P,Ae,N,ii,si):this._cancelItemScroll(t,w))}_updateScrollRequest(t){let e=t.item,{threshold:i,safeZone:s,smoothStop:r,handle:a,targets:d}=Wt(e),o=y(d)?d(e):d,l=o&&o.length||0,c=this._getItemHandleRect(e,a,He),h=null,u=0;for(;u<l;u++){let m=o[u],f=di(m.element||m);if(f!==t.element)continue;let _=!!(R&t.direction);if(_){if(m.axis===w)continue}else if(m.axis===R)continue;let b=_?mi(f):ui(f);if(b<=0)break;let S=fi(f,ci);if(Et(c,S)<=0)break;let E=typeof m.threshold=="number"?m.threshold:i,L=Me(E,_?S.width:S.height),P=Oe(L,s,_?c.width:c.height,_?S.width:S.height),I=0;if(t.direction===St?I=c.left-(S.left-P):t.direction===bt?I=S.right+P-c.right:t.direction===vt?I=c.top-(S.top-P):I=S.bottom+P-c.bottom,I>L)break;let N=_?Xt(f):Yt(f);if(h=Vt&t.direction?N>=b:N<=0,h)break;return t.maxValue=b,t.threshold=L,t.distance=I,t.isEnding=!1,!0}return r===!0&&t.speed>0?(h===null&&(h=t.hasReachedEnd()),t.isEnding=!h):t.isEnding=!1,t.isEnding}_updateRequests(){let t=this._items,e=this._requests[R],i=this._requests[w],s=0;for(;s<t.length;s++){let r=t[s],a=this._requestOverlapCheck.get(r.id)||0,d=a>0&&this._tickTime-a>this._overlapCheckInterval,o=!0,l=e.get(r.id);l&&l.isActive&&(o=!this._updateScrollRequest(l),o&&(d=!0,this._cancelItemScroll(r,R)));let c=!0,h=i.get(r.id);h&&h.isActive&&(c=!this._updateScrollRequest(h),c&&(d=!0,this._cancelItemScroll(r,w))),d&&(this._requestOverlapCheck.set(r.id,0),this._checkItemOverlap(r,o,c))}}_requestAction(t,e){let i=this._actions,s=e===R,r=null,a=0;for(;a<i.length;a++){if(r=i[a],t.element!==r.element){r=null;continue}if(s?r.requestX:r.requestY){this._cancelItemScroll(t.item,e);return}break}r||(r=this._actionPool.pick()),r.element=t.element,r.addRequest(t),t.tick(this._tickDeltaTime),i.push(r)}_updateActions(){let t=this._items,e=this._requests,i=this._actions,s=0;for(s=0;s<t.length;s++){let r=e[R].get(t[s].id),a=e[w].get(t[s].id);r&&this._requestAction(r,R),a&&this._requestAction(a,w)}for(s=0;s<i.length;s++)i[s].computeScrollValues()}_applyActions(){let t=this._actions;if(!t.length)return;let e=0;for(e=0;e<t.length;e++)t[e].scroll(),this._actionPool.release(t[e]);t.length=0;let i=this._items;for(e=0;e<i.length;e++)bs(i[e]);for(e=0;e<i.length;e++)vs(i[e])}};O.AXIS_X=R,O.AXIS_Y=w,O.LEFT=St,O.RIGHT=bt,O.UP=vt,O.DOWN=Gt,O.smoothSpeed=Ss,O.pointerHandle=Es;var dt=new Map,ht=new Map,Y="swap",nt="move",rt="instant",gi="synchronize",j="layoutStart",Xe="layoutEnd",Ye="layoutAbort",We="add",Ve="remove",pi="showStart",yi="showEnd",mt="hideStart",Ei="hideEnd",Fe="filter",qe="sort",Tt="move",It="send",B="beforeSend",At="receive",Lt="beforeReceive",Si="dragInit",bi="dragStart",vi="dragMove",Di="dragScroll",Ti="dragEnd",Ii="dragReleaseStart",ut="dragReleaseEnd",Ai="destroy",Be="ontouchstart"in window,Li=!!window.PointerEvent,xi=window.navigator.userAgent.toLowerCase(),Ri=xi.indexOf("firefox")>-1,Pi=navigator.vendor&&navigator.vendor.indexOf("Apple")>-1&&navigator.userAgent&&navigator.userAgent.indexOf("CriOS")==-1&&navigator.userAgent.indexOf("FxiOS")==-1,wi=xi.indexOf("android")>-1,ki=/^(iPad|iPhone|iPod)/.test(window.navigator.platform)||/^Mac/.test(window.navigator.platform)&&window.navigator.maxTouchPoints>1,Ci=16777216,xt=100,ct=(()=>{let n=!1;try{let t=Object.defineProperty({},"passive",{get:function(){n=!0}});window.addEventListener("testPassive",null,t),window.removeEventListener("testPassive",null,t)}catch(t){}return n})();var ze=["","webkit","moz","ms","o","Webkit","Moz","MS","O"],Mi=new Map;function ft(n,t){let e=Mi.get(t);if(e)return e;let i=t[0].toUpperCase()+t.slice(1),s=0;for(;s<ze.length;){if(e=ze[s]?ze[s]+i:t,e in n)return Mi.set(t,e),e;++s}return""}var Ds={start:"pointerdown",move:"pointermove",cancel:"pointercancel",end:"pointerup"},ge={start:"touchstart",move:"touchmove",cancel:"touchcancel",end:"touchend"},Ts={start:"mousedown",move:"mousemove",cancel:"",end:"mouseup"},W=M({},Be?ge:Li?Ds:Ts),k={start:"start",move:"move",cancel:"cancel",end:"end"},Ue=1,Ni=2,Oi="auto",Gi="touchAction",_e=ft(document.documentElement.style,Gi);function Ft(n){n.preventDefault&&n.cancelable!==!1&&n.preventDefault()}function Hi(n,t){return(n?Ue:0)|(ct&&t?Ni:0)}function qt(n){return ct?{capture:!!(Ue&n),passive:!!(Ni&n)}:!!(Ue&n)}function Is(n){return"pointerType"in n?n.pointerType:"touches"in n?"touch":"mouse"}function As(n){return"pointerId"in n?n.pointerId:"changedTouches"in n?n.changedTouches[0]?n.changedTouches[0].identifier:null:1}function Ls(n,t){if("pointerId"in n)return n.pointerId===t?n:null;if("changedTouches"in n){let e=0;for(;e<n.changedTouches.length;e++)if(n.changedTouches[e].identifier===t)return n.changedTouches[e];return null}return n}var Rt=class{constructor(t){this._emitter=new st({dedupe:X.THROW}),this._listenerOptions=qt(t),this._draggers=new Set,this._onMove=this._onMove.bind(this),this._onCancel=this._onCancel.bind(this),this._onEnd=this._onEnd.bind(this)}hasDragger(t){return this._draggers.has(t)}addDragger(t){this._draggers.has(t)||(this._draggers.add(t),this._emitter.on(k.move,t.onMove,t.onMove),this._emitter.on(k.cancel,t.onCancel,t.onCancel),this._emitter.on(k.end,t.onEnd,t.onEnd),this._draggers.size===1&&this._activate())}removeDragger(t){this._draggers.has(t)&&(this._draggers.delete(t),this._emitter.off(k.move,t.onMove),this._emitter.off(k.cancel,t.onCancel),this._emitter.off(k.end,t.onEnd),this._draggers.size===0&&this._deactivate())}destroy(){this._draggers.size&&this._deactivate(),this._draggers.clear(),this._emitter.off()}_activate(){window.addEventListener(W.move,this._onMove,this._listenerOptions),window.addEventListener(W.end,this._onEnd,this._listenerOptions),W.cancel&&window.addEventListener(W.cancel,this._onCancel,this._listenerOptions)}_deactivate(){window.removeEventListener(W.move,this._onMove,this._listenerOptions),window.removeEventListener(W.end,this._onEnd,this._listenerOptions),W.cancel&&window.removeEventListener(W.cancel,this._onCancel,this._listenerOptions)}_onMove(t){this._emitter.emit(k.move,t)}_onCancel(t){this._emitter.emit(k.cancel,t)}_onEnd(t){this._emitter.emit(k.end,t)}},Bt=[new Rt(0),new Rt(1)];ct&&Bt.push(new Rt(2),new Rt(3));var zt=class{constructor(t,e,i={}){let{capture:s=!0,passive:r=!0}=i;this.element=t,this._emitter=new st({dedupe:X.THROW}),this._cssProps={},this._touchAction="",this._listenerType=Hi(s,r),this._isActive=!1,this._pointerId=null,this._startTime=0,this._startX=0,this._startY=0,this._currentX=0,this._currentY=0,this.onStart=this.onStart.bind(this),this.onMove=this.onMove.bind(this),this.onCancel=this.onCancel.bind(this),this.onEnd=this.onEnd.bind(this),e&&this.setCssProps(e),this._touchAction||this.setTouchAction(Oi),t.addEventListener("dragstart",Ft,!1),t.addEventListener(W.start,this.onStart,qt(this._listenerType))}getTrackedTouch(t){return this._pointerId===null?null:Ls(t,this._pointerId)}onStart(t){if(!this.element||this._pointerId!==null||(this._pointerId=As(t),this._pointerId===null))return;let e=this.getTrackedTouch(t);if(e&&(this._startX=this._currentX=e.clientX,this._startY=this._currentY=e.clientY,this._startTime=Date.now(),this._isActive=!0,this._emit(k.start,t),this._isActive)){let i=Bt[this._listenerType];i&&i.addDragger(this)}}onMove(t){let e=this.getTrackedTouch(t);e&&(this._currentX=e.clientX,this._currentY=e.clientY,this._emit(k.move,t))}onCancel(t){this.getTrackedTouch(t)&&(this._emit(k.cancel,t),this.reset())}onEnd(t){this.getTrackedTouch(t)&&(this._emit(k.end,t),this.reset())}isActive(){return this._isActive}setTouchAction(t){!this.element||!t||(this._touchAction=t,_e&&(this._cssProps[_e]="",this.element.style[_e]=t),Be&&(this.element.removeEventListener(ge.start,Ft,!0),t!==Oi&&(this.element.style[_e]!==t||Ri&&wi)&&this.element.addEventListener(ge.start,Ft,!0)))}setCssProps(t){if(!this.element)return;let e=this._cssProps,{element:i}=this,s="";for(s in e)i.style[s]=e[s],delete e[s];let r;for(r in t){let a=t[r]||"";if(!a)continue;if(r===Gi){this.setTouchAction(a);continue}let d=ft(i.style,r);d&&(e[d]="",i.style[d]=a)}}setListenerOptions(t){if(!this.element)return;let{capture:e=!0,passive:i=!0}=t,s=this._listenerType,r=Hi(e,i);if(s!==r){this.element.removeEventListener(W.start,this.onStart,qt(this._listenerType));let a=Bt[this._listenerType],d=a?a.hasDragger(this):!1;if(d&&a.removeDragger(this),this._listenerType=r,this.element.addEventListener(W.start,this.onStart,qt(this._listenerType)),d){let o=Bt[this._listenerType];o&&o.addDragger(this)}}}getDeltaX(){return this._currentX-this._startX}getDeltaY(){return this._currentY-this._startY}getDistance(){let t=this.getDeltaX(),e=this.getDeltaY();return Math.sqrt(t*t+e*e)}getDeltaTime(){return this._startTime?Date.now()-this._startTime:0}on(t,e,i){return this._emitter.on(t,e,i)}off(t,e){return this._emitter.off(t,e)}reset(){this._pointerId=null,this._startTime=0,this._startX=0,this._startY=0,this._currentX=0,this._currentY=0,this._isActive=!1;let t=Bt[this._listenerType];t&&t.removeDragger(this)}destroy(){let{element:t}=this;if(!t)return;this.reset(),this._emitter.off(),t.removeEventListener(W.start,this.onStart,qt(this._listenerType)),t.removeEventListener("dragstart",Ft,!1),t.removeEventListener(ge.start,Ft,!0);let e;for(e in this._cssProps)t.style[e]="";this._cssProps={},this.element=null}_createEvent(t,e){let i=this.getTrackedTouch(e);return!i||this._pointerId===null?null:{type:t,srcEvent:e,distance:this.getDistance(),deltaX:this.getDeltaX(),deltaY:this.getDeltaY(),deltaTime:t===k.start?0:this.getDeltaTime(),isFirst:t===k.start,isFinal:t===k.end||t===k.cancel,pointerType:Is(e),identifier:this._pointerId,screenX:i.screenX,screenY:i.screenY,clientX:i.clientX,clientY:i.clientY,pageX:i.pageX,pageY:i.pageY,target:i.target}}_emit(t,e){this._emitter.emit(t,this._createEvent(t,e))}};function A(n,t){t&&n.classList.add(t)}function Pt(n,t,e=-1){e<0&&(e=n.length-e+1),Array.isArray(t)?n.splice(e,0,...t):n.splice(e,0,t)}function Q(n,t,e=0){let i=Math.max(0,n.length-1+e);return t>i?i:t<0?Math.max(i+t+1,0):t}function pe(n,t,e){if(n.length<2)return;let i=Q(n,t),s=Q(n,e);i!==s&&n.splice(s,0,n.splice(i,1)[0])}function ye(n,t,e){if(n.length<2)return;let i=Q(n,t),s=Q(n,e);if(i!==s){let r=n[i];n[i]=n[s],n[s]=r}}var H=ft(document.documentElement.style,"transform")||"transform";var xs=/([A-Z])/g,Rs=/^(webkit-|moz-|ms-|o-)/,Ps=/^(-m-s-)/;function Ut(n){let t=n.replace(xs,"-$1").toLowerCase();return t=t.replace(Rs,"-$1"),t=t.replace(Ps,"-ms-"),t}var Ee=Ut(H);function Xi(n){if(x(n,"position")!=="static")return!0;let t=x(n,"display");if(t==="inline"||t==="none")return!1;let e=x(n,Ee);if(e&&e!=="none")return!0;let i=x(n,"perspective");if(i&&i!=="none")return!0;let s=x(n,"content-visibility");if(s&&(s==="auto"||s==="hidden"))return!0;let r=x(n,"contain");if(r&&(r==="strict"||r==="content"||r.indexOf("paint")>-1||r.indexOf("layout")>-1))return!0;if(!Pi){let a=x(n,"filter");if(a&&a!=="none")return!0;let d=x(n,"will-change");if(d&&(d.indexOf("transform")>-1||d.indexOf("perspective")>-1))return!0}return!1}function _t(n){let t=n||document;for(;t&&t!==document&&!Xi(n);)t=t.parentElement||document;return t}var je={left:0,top:0},Qe={left:0,top:0},gt={left:0,top:0};function Yi(n,t={left:0,top:0}){if(t.left=0,t.top=0,n===document||(t.left=window.pageXOffset||0,t.top=window.pageYOffset||0,"self"in n&&n.self===window.self))return t;let{left:e,top:i}=n.getBoundingClientRect();return t.left+=e,t.top+=i,t.left+=C(n,"border-left-width"),t.top+=C(n,"border-top-width"),t}function Z(n,t,e=!1){return gt.left=0,gt.top=0,n===t||e&&(n=_t(n),t=_t(t),n===t)||(Yi(n,je),Yi(t,Qe),gt.left=Qe.left-je.left,gt.top=Qe.top-je.top),gt}function T(n,t){t&&n.classList.remove(t)}var Se=0,Ze=1,be=2,Wi=ct?{capture:!0,passive:!0}:!0,Vi={left:0,top:0,width:0,height:0},Fi={left:0,top:0,width:0,height:0},ws=function(n,t,e){if(t.isFinal)return;let i=n._drag;if(t.isFirst&&t.srcEvent.button||!ki&&t.isFirst&&t.srcEvent.isTrusted===!0&&t.srcEvent.defaultPrevented===!1&&t.srcEvent.cancelable===!1)return i._resetDefaultStartPredicate(),!1;let s=i._startPredicateData;if(!s){s=i._startPredicateData={distance:0,delay:0};let{dragStartPredicate:r}=n.getGrid().settings,a=e||r;typeof a=="object"&&(s.distance=Math.max(a.distance||0,0),s.delay=Math.max(a.delay||0,0))}if(s.delay){s.event=t,s.delayTimer||(s.delayTimer=window.setTimeout(function(){if(i._startPredicateData===s){if(!i.item){i._resetDefaultStartPredicate();return}s&&(s.delay=0,i._startPredicateState===Ze&&s.event&&s.event.distance>=s.distance&&(i._resetDefaultStartPredicate(),i._startPredicateState=be,i._onStart(s.event)))}},s.delay));return}if(!(t.distance<s.distance))return!0},ks=function(n,t){let e=n.getGrid(),{dragSort:i}=e.settings,s=i===!0?[e]:y(i)?i(n):void 0,r=null;if(!s||!Array.isArray(s)||!s.length)return r;let a=Vi,d=Fi,o=-1,l=0,c,h=null,u,m=0,f=0,_=0,b=0,S=0,p=n._drag;for(a.width=n.width,a.height=n.height,a.left=p._clientX,a.top=p._clientY;S<s.length;S++)if(c=s[S],!c.isDestroyed()){for(c._updateBoundingRect(),m=Math.max(0,c._rect.left),f=Math.max(0,c._rect.top),_=Math.min(window.innerWidth,c._rect.right),b=Math.min(window.innerHeight,c._rect.bottom),h=c.element.parentNode;h&&h!==document&&h!==document.documentElement&&h!==document.body;){if(h.getRootNode&&h instanceof DocumentFragment){h=h.getRootNode().host;continue}if(x(h,"overflow")!=="visible"&&(u=h.getBoundingClientRect(),m=Math.max(m,u.left),f=Math.max(f,u.top),_=Math.min(_,u.right),b=Math.min(b,u.bottom)),x(h,"position")==="fixed")break;h=h.parentNode}m>=_||f>=b||(d.left=m,d.top=f,d.width=_-m,d.height=b-f,l=Et(a,d),l>t&&l>o&&(o=l,r=c))}return r},Cs=function(n,t){let e=n._drag,i=t&&t.action===Y?Y:nt,s=t&&t.migrateAction===Y?Y:nt,r=Math.min(Math.max(t&&typeof t.threshold=="number"?t.threshold:50,1),100),a=ks(n,r);if(!a)return null;let d=n.getGrid()!==a,o=Vi,l=Fi;o.width=n.width,o.height=n.height,d?(a._updateBorders(!0,!1,!0,!1),o.left=e._clientX-(a._rect.left+a._borderLeft),o.top=e._clientY-(a._rect.top+a._borderTop)):(o.left=e._translateX-n._containerDiffX+n.marginLeft,o.top=e._translateY-n._containerDiffY+n.marginTop);let c=0,h=-1,u=!1;for(let m=0;m<a.items.length;m++){let f=a.items[m];if(!f.isActive()||f===n)continue;u=!0,l.width=f.width,l.height=f.height,l.left=f.left+f.marginLeft,l.top=f.top+f.marginTop;let _=Et(o,l);_>c&&(h=m,c=_)}return d&&c<r&&(h=u?h:0,c=r),c>=r?{grid:a,index:h,action:d?s:i}:null},G=class G{constructor(t){let e=t.element,i=t.getGrid(),{settings:s}=i;this.item=t,this._originGridId=i.id,this._isMigrated=!1,this._isActive=!1,this._isStarted=!1,this._dragStartId=Symbol(),this._dragMoveId=Symbol(),this._dragScrollId=Symbol(),this._dragSortId=Symbol(),this._startPredicateState=Se,this._startPredicateData=null,this._isSortNeeded=!1,this._sortTimer=void 0,this._blockedSortIndex=null,this._sortX1=0,this._sortX2=0,this._sortY1=0,this._sortY2=0,this._container=null,this._containingBlock=null,this._dragStartEvent=null,this._dragEndEvent=null,this._dragMoveEvent=null,this._dragPrevMoveEvent=null,this._scrollEvent=null,this._translateX=0,this._translateY=0,this._clientX=0,this._clientY=0,this._scrollDiffX=0,this._scrollDiffY=0,this._moveDiffX=0,this._moveDiffY=0,this._containerDiffX=0,this._containerDiffY=0,this._preStartCheck=this._preStartCheck.bind(this),this._preEndCheck=this._preEndCheck.bind(this),this._onScroll=this._onScroll.bind(this),this._prepareStart=this._prepareStart.bind(this),this._applyStart=this._applyStart.bind(this),this._prepareMove=this._prepareMove.bind(this),this._applyMove=this._applyMove.bind(this),this._prepareScroll=this._prepareScroll.bind(this),this._applyScroll=this._applyScroll.bind(this),this._handleSort=this._handleSort.bind(this),this._handleSortDelayed=this._handleSortDelayed.bind(this),this.dragger=new zt(typeof s.dragHandle=="string"&&e.querySelector(s.dragHandle)||e,s.dragCssProps,s.dragEventListenerOptions),this.dragger.on("start",this._preStartCheck,this._preStartCheck),this.dragger.on("move",this._preStartCheck,this._preStartCheck),this.dragger.on("cancel",this._preEndCheck,this._preEndCheck),this.dragger.on("end",this._preEndCheck,this._preEndCheck)}isActive(){return this._isActive}getOriginGrid(){return dt.get(this._originGridId)||null}stop(){if(!this.item||!this.isActive())return;if(this._isMigrated){this._finishMigration();return}let{item:t}=this;if(G.autoScroll.removeItem(t),g.off(v,this._dragStartId),g.off(D,this._dragStartId),g.off(v,this._dragMoveId),g.off(D,this._dragMoveId),g.off(v,this._dragScrollId),g.off(D,this._dragScrollId),this._cancelSort(),this._isStarted){let e=t.element,i=t.getGrid(),{itemDraggingClass:s}=i.settings;this._unbindScrollHandler(),e.parentNode!==i.element&&(i.element.appendChild(e),t._setTranslate(this._translateX-t._containerDiffX,this._translateY-t._containerDiffY),t._containerDiffX=this._containerDiffX=0,t._containerDiffY=this._containerDiffY=0,s&&e.clientWidth),T(e,s)}this._reset()}sort(t=!1){this.item&&this.isActive()&&this.item.isActive()&&this._dragMoveEvent&&(t?this._handleSort():g.once(lt,this._handleSort,this._dragSortId))}destroy(){this.item&&(this._isMigrated=!1,this.stop(),this.dragger.destroy(),this.item=null)}_startPredicate(t,e){let{dragStartPredicate:i}=t.getGrid().settings;return y(i)?i(t,e):G.defaultStartPredicate(t,e)}_reset(){this._isActive=!1,this._isStarted=!1,this._container=null,this._containingBlock=null,this._dragStartEvent=null,this._dragEndEvent=null,this._dragMoveEvent=null,this._dragPrevMoveEvent=null,this._scrollEvent=null,this._translateX=0,this._translateY=0,this._clientX=0,this._clientY=0,this._scrollDiffX=0,this._scrollDiffY=0,this._moveDiffX=0,this._moveDiffY=0,this._containerDiffX=0,this._containerDiffY=0}_bindScrollHandler(){window.addEventListener("scroll",this._onScroll,Wi)}_unbindScrollHandler(){window.removeEventListener("scroll",this._onScroll,Wi)}_resetHeuristics(t,e){this._blockedSortIndex=null,this._sortX1=this._sortX2=t,this._sortY1=this._sortY2=e}_checkHeuristics(t,e){if(!this.item)return!1;let{settings:i}=this.item.getGrid(),{minDragDistance:s,minBounceBackAngle:r}=i.dragSortHeuristics;if(s<=0)return this._blockedSortIndex=null,!0;let a=t-this._sortX2,d=e-this._sortY2,o=s>3&&r>0;if(o||(this._blockedSortIndex=null),Math.abs(a)>s||Math.abs(d)>s){if(o){let l=Math.atan2(a,d),c=Math.atan2(this._sortX2-this._sortX1,this._sortY2-this._sortY1),h=Math.atan2(Math.sin(l-c),Math.cos(l-c));Math.abs(h)>r&&(this._blockedSortIndex=null)}return this._sortX1=this._sortX2,this._sortY1=this._sortY2,this._sortX2=t,this._sortY2=e,!0}return!1}_resetDefaultStartPredicate(){let{_startPredicateData:t}=this;t&&(t.delayTimer&&(t.delayTimer=void window.clearTimeout(t.delayTimer)),this._startPredicateData=null)}_handleSort(){if(!this.item||!this.isActive())return;let{item:t}=this,{dragSort:e,dragSortHeuristics:i,dragAutoScroll:s}=t.getGrid().settings;if(!e||!s.sortDuringScroll&&G.autoScroll.isItemScrolling(t)){this._sortX1=this._sortX2=this._translateX-t._containerDiffX,this._sortY1=this._sortY2=this._translateY-t._containerDiffY,this._isSortNeeded=!0,this._sortTimer!==void 0&&(this._sortTimer=void window.clearTimeout(this._sortTimer));return}let r=this._checkHeuristics(this._translateX-t._containerDiffX,this._translateY-t._containerDiffY);if(!this._isSortNeeded&&!r)return;let a=i.sortInterval;a<=0||this._isSortNeeded?(this._isSortNeeded=!1,this._sortTimer!==void 0&&(this._sortTimer=void window.clearTimeout(this._sortTimer)),this._checkOverlap()):this._sortTimer===void 0&&(this._sortTimer=window.setTimeout(this._handleSortDelayed,a))}_handleSortDelayed(){this.item&&(this._isSortNeeded=!0,this._sortTimer=void 0,g.once(lt,this._handleSort,this._dragSortId))}_cancelSort(){this.item&&(this._isSortNeeded=!1,this._sortTimer!==void 0&&(this._sortTimer=void window.clearTimeout(this._sortTimer)),g.off(lt,this._dragSortId))}_finishSort(){if(!this.item)return;let{dragSort:t}=this.item.getGrid().settings,e=t&&(this._isSortNeeded||this._sortTimer!==void 0);this._cancelSort(),e&&this._checkOverlap(),t&&this._checkOverlap(!0)}_checkOverlap(t=!1){if(!this.item||!this.isActive())return;let{item:e}=this,i=e.element,s=e.getGrid(),{settings:r}=s,a=null;if(y(r.dragSortPredicate)?a=r.dragSortPredicate(e,t?this._dragEndEvent:this._dragMoveEvent):t||(a=G.defaultSortPredicate(e,r.dragSortPredicate)),!a||typeof a.index!="number")return;let d=a.action===Y?Y:nt,o=a.grid||s,l=s!==o,c=s.items.indexOf(e),h=Q(o.items,a.index,l&&d===nt?1:0);if(!(!l&&h===this._blockedSortIndex))if(!l)c!==h&&(this._blockedSortIndex=c,(d===Y?ye:pe)(s.items,c,h),s._hasListeners(Tt)&&s._emit(Tt,{item:e,fromIndex:c,toIndex:h,action:d}),s.layout());else{this._blockedSortIndex=null;let u=o.items[h],m=o.settings;if(s._hasListeners(B)&&s._emit(B,{item:e,fromGrid:s,fromIndex:c,toGrid:o,toIndex:h}),o._hasListeners(Lt)&&o._emit(Lt,{item:e,fromGrid:s,fromIndex:c,toGrid:o,toIndex:h}),!this.isActive()||s.isDestroyed()||o.isDestroyed())return;e._gridId=o.id,this._isMigrated=e._gridId!==this._originGridId,s.items.splice(c,1),Pt(o.items,e,h),e._sortData=null;let f=this._container,_=this._containingBlock,b=m.dragContainer||o.element,S=_t(b),p=Z(S,_t(o.element));e._containerDiffX=this._containerDiffX=p.left,e._containerDiffY=this._containerDiffY=p.top,b!==f&&(p=Z(_,S),this._container=b,this._containingBlock=S,this._translateX-=p.left,this._translateY-=p.top,b.appendChild(i),e._setTranslate(this._translateX,this._translateY)),r.itemClass!==m.itemClass&&(T(i,r.itemClass),A(i,m.itemClass)),r.itemDraggingClass!==m.itemDraggingClass&&(T(i,r.itemDraggingClass),A(i,m.itemDraggingClass)),e.isActive()?(r.itemVisibleClass!==m.itemVisibleClass&&(T(i,r.itemVisibleClass),A(i,m.itemVisibleClass)),e._visibility.setStyles(m.visibleStyles)):(r.itemHiddenClass!==m.itemHiddenClass&&(T(i,r.itemHiddenClass),A(i,m.itemHiddenClass)),e._visibility.setStyles(m.hiddenStyles)),e._dragPlaceholder.updateClassName(m.itemPlaceholderClass),e._updateDimensions(),s._hasListeners(It)&&s._emit(It,{item:e,fromGrid:s,fromIndex:c,toGrid:o,toIndex:h}),o._hasListeners(At)&&o._emit(At,{item:e,fromGrid:s,fromIndex:c,toGrid:o,toIndex:h}),d===Y&&u&&u.isActive()&&o.items.indexOf(u)>-1&&o.send(u,s,c,{appendTo:f||document.body,layoutSender:!1,layoutReceiver:!1}),s.layout(),o.layout()}}_finishMigration(){if(!this.item)return;let{item:t}=this,{dragEnabled:e}=t.getGrid().settings;this.destroy(),t._drag=e?new G(t):null,t._dragRelease.start()}_preStartCheck(t){if(this._startPredicateState===Se&&(this._startPredicateState=Ze),this._startPredicateState===Ze){let e=this._startPredicate(this.item,t);e===!0?(this._startPredicateState=be,this._onStart(t)):e===!1&&(this._startPredicateState=Se,this.dragger.reset())}else this._startPredicateState===be&&this.isActive()&&this._onMove(t)}_preEndCheck(t){let e=this._startPredicateState===be;this._startPredicate(this.item,t),this._resetDefaultStartPredicate(),this._startPredicateState=Se,!(!e||!this.isActive())&&(this._isStarted?this._onEnd(t):this.stop())}_onStart(t){!this.item||!this.item.isActive()||(this._isActive=!0,this._dragStartEvent=t,G.autoScroll.addItem(this.item,this._translateX,this._translateY),g.once(v,this._prepareStart,this._dragStartId),g.once(D,this._applyStart,this._dragStartId))}_prepareStart(){if(!this.item||!this.isActive()||!this.item.isActive())return;let{item:t}=this,e=t.element,i=t.getGrid(),s=i.settings.dragContainer||i.element,r=_t(s),a=t._getTranslate(),d=e.getBoundingClientRect();if(this._container=s,this._containingBlock=r,this._clientX=d.left,this._clientY=d.top,this._translateX=a.x,this._translateY=a.y,this._scrollDiffX=this._scrollDiffY=0,this._moveDiffX=this._moveDiffY=0,this._containerDiffX=this._containerDiffY=0,s!==i.element){let{left:o,top:l}=Z(r,i.element);this._containerDiffX=o,this._containerDiffY=l}this._resetHeuristics(this._translateX-t._containerDiffX,this._translateY-t._containerDiffY)}_applyStart(){if(!this.item||!this.isActive())return;let{item:t}=this;if(!t.isActive())return;t.isPositioning()&&t._layout.stop(!0,this._translateX,this._translateY);let e=t._migrate;e.isActive()&&(this._translateX-=t._containerDiffX,this._translateY-=t._containerDiffY,e.stop(!0,this._translateX,this._translateY));let i=t._dragRelease;t.isReleasing()&&i.reset();let s=t.getGrid(),r=t.element;s.settings.dragPlaceholder.enabled&&t._dragPlaceholder.create(),this._isStarted=!0,this._dragStartEvent&&s._emit(Si,t,this._dragStartEvent),r.parentNode!==this._container&&(this._translateX+=this._containerDiffX,this._translateY+=this._containerDiffY,this._container.appendChild(r),t._setTranslate(this._translateX,this._translateY)),t._containerDiffX=this._containerDiffX,t._containerDiffY=this._containerDiffY,A(r,s.settings.itemDraggingClass),this._bindScrollHandler(),this._dragStartEvent&&s._emit(bi,t,this._dragStartEvent)}_onMove(t){if(this.item){if(!this.item.isActive()){this.stop();return}this._dragMoveEvent=t,g.once(v,this._prepareMove,this._dragMoveId),g.once(D,this._applyMove,this._dragMoveId),g.once(lt,this._handleSort,this._dragSortId)}}_prepareMove(){if(!this.item||!this.isActive()||!this.item.isActive())return;let{dragAxis:t}=this.item.getGrid().settings,e=this._dragMoveEvent,i=this._dragPrevMoveEvent||this._dragStartEvent||e;if(t!=="y"){let s=e.clientX-i.clientX;this._translateX=this._translateX-this._moveDiffX+s,this._clientX=this._clientX-this._moveDiffX+s,this._moveDiffX=s}if(t!=="x"){let s=e.clientY-i.clientY;this._translateY=this._translateY-this._moveDiffY+s,this._clientY=this._clientY-this._moveDiffY+s,this._moveDiffY=s}this._dragPrevMoveEvent=e}_applyMove(){if(!this.item||!this.isActive()||!this.item.isActive())return;let{item:t}=this,e=t.getGrid();this._moveDiffX=this._moveDiffY=0,t._setTranslate(this._translateX,this._translateY),this._dragMoveEvent&&e._emit(vi,t,this._dragMoveEvent),G.autoScroll.updateItem(t,this._translateX,this._translateY)}_onScroll(t){if(this.item){if(!this.item.isActive()){this.stop();return}this._scrollEvent=t,g.once(v,this._prepareScroll,this._dragScrollId),g.once(D,this._applyScroll,this._dragScrollId),g.once(lt,this._handleSort,this._dragSortId)}}_prepareScroll(){if(!this.item||!this.isActive()||!this.item.isActive())return;let{item:t}=this,e=t.getGrid();if(this._container!==e.element){let{left:a,top:d}=Z(this._containingBlock,e.element);t._containerDiffX=this._containerDiffX=a,t._containerDiffY=this._containerDiffY=d}let{dragAxis:i}=e.settings,{left:s,top:r}=t.element.getBoundingClientRect();if(i!=="y"){let a=this._clientX-this._moveDiffX-this._scrollDiffX-s;this._translateX=this._translateX-this._scrollDiffX+a,this._scrollDiffX=a}if(i!=="x"){let a=this._clientY-this._moveDiffY-this._scrollDiffY-r;this._translateY=this._translateY-this._scrollDiffY+a,this._scrollDiffY=a}}_applyScroll(){if(!this.item||!this.isActive()||!this.item.isActive())return;let{item:t}=this,e=t.getGrid();this._scrollDiffX=this._scrollDiffY=0,t._setTranslate(this._translateX,this._translateY),this._scrollEvent&&e._emit(Di,t,this._scrollEvent)}_onEnd(t){if(!this.item)return;let{item:e}=this;if(!e.isActive()){this.stop();return}let i=e.getGrid();this._dragEndEvent=t,g.off(v,this._dragStartId),g.off(D,this._dragStartId),g.off(v,this._dragMoveId),g.off(D,this._dragMoveId),g.off(v,this._dragScrollId),g.off(D,this._dragScrollId),this._finishSort(),this._unbindScrollHandler(),this._reset(),T(e.element,i.settings.itemDraggingClass),G.autoScroll.removeItem(e),i._emit(Ti,e,t),this._isMigrated?this._finishMigration():e._dragRelease.start()}};G.autoScroll=new O,G.defaultStartPredicate=ws,G.defaultSortPredicate=Cs;var ot=G;function z(n,t,e=!1){return e?"translate3d("+n+"px, "+t+"px, 0px)":"translateX("+n+"px) translateY("+t+"px)"}var wt={x:0,y:0},Ms="none",Os=/^matrix3d/,Hs=/([^,]*,){4}/,Ns=/([^,]*,){12}/,Gs=/[^,]*,/;function kt(n){wt.x=0,wt.y=0;let t=x(n,Ee);if(!t||t===Ms)return wt;let e=Os.test(t),i=t.replace(e?Ns:Hs,""),s=i.replace(Gs,"");return wt.x=parseFloat(i)||0,wt.y=parseFloat(s)||0,wt}var qi={},Bi={},jt=class{constructor(t){this.item=t,this.element=null,this.animator=new it,this.left=0,this.top=0,this._className="",this._didMigrate=!1,this._resetAfterLayout=!1,this._transX=0,this._transY=0,this._nextTransX=0,this._nextTransY=0,this._layoutListenerId=Symbol(),this._resizeListenerId=Symbol(),this._setupAnimation=this._setupAnimation.bind(this),this._startAnimation=this._startAnimation.bind(this),this._updateDimensions=this._updateDimensions.bind(this),this._onLayoutStart=this._onLayoutStart.bind(this),this._onLayoutEnd=this._onLayoutEnd.bind(this),this._onReleaseEnd=this._onReleaseEnd.bind(this),this._onMigrate=this._onMigrate.bind(this),this._onHide=this._onHide.bind(this)}create(){if(!this.item)return;if(this.element){this._resetAfterLayout=!1;return}let{item:t}=this,e=t.getGrid(),{settings:i}=e;this.left=t.left,this.top=t.top;let s;y(i.dragPlaceholder.createElement)?s=i.dragPlaceholder.createElement(t):s=document.createElement("div"),this.element=s,this.animator.element=s,this._className=i.itemPlaceholderClass||"",this._className&&A(s,this._className),q(s,{position:"absolute",left:"0px",top:"0px",width:t.width+"px",height:t.height+"px"}),s.style[H]=z(t.left+t.marginLeft,t.top+t.marginTop,i.translate3d),e.on(j,this._onLayoutStart,this._onLayoutStart),e.on(ut,this._onReleaseEnd,this._onReleaseEnd),e.on(B,this._onMigrate,this._onMigrate),e.on(mt,this._onHide,this._onHide),y(i.dragPlaceholder.onCreate)&&i.dragPlaceholder.onCreate(t,s),e.element.appendChild(s)}reset(){var a;if(!this.item||!this.element)return;let{item:t,element:e,animator:i}=this,s=t.getGrid();this._resetAfterLayout=!1,g.off(v,this._layoutListenerId),g.off(D,this._layoutListenerId),g.off(D,this._resizeListenerId),i.stop(),i.element=null,s.off(ut,this._onReleaseEnd),s.off(j,this._onLayoutStart),s.off(B,this._onMigrate),s.off(mt,this._onHide),this._className&&(T(e,this._className),this._className=""),(a=e.parentNode)==null||a.removeChild(e),this.element=null;let{onRemove:r}=s.settings.dragPlaceholder;y(r)&&r(t,e)}isActive(){return!!this.element}updateDimensions(){!this.item||!this.isActive()||g.once(D,this._updateDimensions,this._resizeListenerId)}updateClassName(t){this.element&&(T(this.element,this._className),this._className=t,A(this.element,t))}destroy(){this.reset(),this.animator&&this.animator.destroy(),this.item=null}_updateDimensions(){!this.item||!this.element||q(this.element,{width:this.item.width+"px",height:this.item.height+"px"})}_onLayoutStart(t,e){if(!this.item||!this.element)return;let{item:i}=this;if(t.indexOf(i)===-1){this.reset();return}let s=i.left,r=i.top,a=this.left,d=this.top;if(this.left=s,this.top=r,!e&&!this._didMigrate&&a===s&&d===r)return;let o=s+i.marginLeft,l=r+i.marginTop,c=i.getGrid();if(!(!e&&c.settings.layoutDuration>0)||this._didMigrate){g.off(v,this._layoutListenerId),g.off(D,this._layoutListenerId),this.element.style[H]=z(o,l,c.settings.translate3d),this.animator.stop(),this._didMigrate&&(c.element.appendChild(this.element),this._didMigrate=!1);return}this.animator.animation&&(this.animator.animation.onfinish=null),this._nextTransX=o,this._nextTransY=l,g.once(v,this._setupAnimation,this._layoutListenerId),g.once(D,this._startAnimation,this._layoutListenerId)}_setupAnimation(){if(!this.element)return;let{x:t,y:e}=kt(this.element);this._transX=t,this._transY=e}_startAnimation(){if(!this.item||!this.element)return;let{animator:t}=this,e=this._transX,i=this._transY,s=this._nextTransX,r=this._nextTransY,{layoutDuration:a,layoutEasing:d,translate3d:o}=this.item.getGrid().settings;if(e===s&&i===r){t.isAnimating()&&(this.element.style[H]=z(s,r,o),t.stop());return}qi[H]=z(e,i,o),Bi[H]=z(s,r,o),t.start(qi,Bi,{duration:a,easing:d,onFinish:this._onLayoutEnd})}_onLayoutEnd(){this._resetAfterLayout&&this.reset()}_onReleaseEnd(t){if(this.item&&this.item.id===t.id){if(!this.animator.isAnimating()){this.reset();return}this._resetAfterLayout=!0}}_onMigrate(t){if(!this.item||this.item!==t.item)return;let e=this.item.getGrid();e.off(ut,this._onReleaseEnd),e.off(j,this._onLayoutStart),e.off(B,this._onMigrate),e.off(mt,this._onHide);let i=t.toGrid;i.on(ut,this._onReleaseEnd,this._onReleaseEnd),i.on(j,this._onLayoutStart,this._onLayoutStart),i.on(B,this._onMigrate,this._onMigrate),i.on(mt,this._onHide,this._onHide),this._didMigrate=!0}_onHide(t){this.item&&t.indexOf(this.item)>-1&&this.reset()}};var zi=ct?{capture:!0,passive:!0}:!0,Qt=class{constructor(t){this.item=t,this._id=Symbol(),this._isActive=!1,this._isPositioning=!1,this._onScroll=this._onScroll.bind(this)}isActive(){return this._isActive}isPositioning(){return this._isPositioning}start(){if(!this.item||this.isActive())return;let{item:t}=this,e=t.getGrid(),{settings:i}=e;this._isActive=!0,A(t.element,i.itemReleasingClass),i.dragRelease.useDragContainer?t.element.parentNode!==e.element&&window.addEventListener("scroll",this._onScroll,zi):this._placeToGrid(),e._emit(Ii,t),e._nextLayoutData||t._layout.start(!1)}stop(t=!1,e,i){if(!this.item||!this.isActive())return;let{item:s}=this;!t&&(e===void 0||i===void 0)&&(e=s.left,i=s.top);let r=this._placeToGrid(e,i);this.reset(r),t||s.getGrid()._emit(ut,s)}reset(t=!1){if(!this.item)return;let{item:e}=this,{itemReleasingClass:i}=e.getGrid().settings;this._isActive=!1,this._isPositioning=!1,g.off(v,this._id),g.off(D,this._id),window.removeEventListener("scroll",this._onScroll,zi),i&&(t&&e.element.clientWidth,T(e.element,i))}destroy(){this.item&&(this.stop(!0),this.item=null)}_placeToGrid(t,e){if(!this.item)return!1;let{item:i}=this,s=i.getGrid().element;if(i.element.parentNode!==s){if(t===void 0||e===void 0){let{x:r,y:a}=i._getTranslate();t=r-i._containerDiffX,e=a-i._containerDiffY}return s.appendChild(i.element),i._setTranslate(t,e),i._containerDiffX=0,i._containerDiffY=0,!0}return!1}_onScroll(){if(!this.item||!this.isActive())return;let{item:t}=this,e=0,i=0;g.once(v,()=>{if(!this.isActive())return;let s=t.element.parentNode;if(s){let r=t.getGrid().element,{left:a,top:d}=Z(s,r,!0);e=a,i=d}},this._id),g.once(D,()=>{this.isActive()&&(Math.abs(e-t._containerDiffX)>.1||Math.abs(i-t._containerDiffY)>.1)&&(t._containerDiffX=e,t._containerDiffY=i,t._dragPlaceholder.reset(),t._layout.stop(!0,t.left,t.top),this.stop(!1,t.left,t.top))},this._id)}};var Ui=2,ji={},Qi={},Zt={duration:0,easing:"",onFinish:void 0},Kt=class{constructor(t){this.item=t,this.animator=new it(t.element),this._id=Symbol(),this._skipNextAnimation=!1,this._isActive=!1,this._isInterrupted=!1,this._easing="",this._duration=0,this._tX=0,this._tY=0,this._setupAnimation=this._setupAnimation.bind(this),this._startAnimation=this._startAnimation.bind(this),this._finish=this._finish.bind(this);let{style:e}=t.element;e.left="0px",e.top="0px",this.item._setTranslate(0,0)}isActive(){return this._isActive}start(t,e){if(!this.item)return;let{item:i,animator:s}=this,r=i.getGrid(),a=i._dragRelease,{settings:d}=r,o=this.isActive(),l=a.isActive()&&!a.isPositioning(),c=l?d.dragRelease.duration:d.layoutDuration,h=l?d.dragRelease.easing:d.layoutEasing,u=!t&&!this._skipNextAnimation&&c>0;if(o&&(g.off(v,this._id),g.off(D,this._id),i._emitter.emit(this._id,!0,i)),l&&(a._isPositioning=!0),e&&y(e)&&i._emitter.once(this._id,e),this._skipNextAnimation=!1,!u){i._setTranslate(i.left+i._containerDiffX,i.top+i._containerDiffY),s.stop(),this._finish();return}s.animation&&(s.animation.onfinish=null),r._layoutNeedsDimensionsRefresh=!0,this._isActive=!0,this._easing=h,this._duration=c,this._isInterrupted=o,g.once(v,this._setupAnimation,this._id),g.once(D,this._startAnimation,this._id)}stop(t,e,i){if(!this.item||!this.isActive())return;let{item:s}=this;if(g.off(v,this._id),g.off(D,this._id),this.animator.isAnimating()){if(e===void 0||i===void 0){let{x:a,y:d}=kt(s.element);s._setTranslate(a,d)}else s._setTranslate(e,i);this.animator.stop()}let{itemPositioningClass:r}=s.getGrid().settings;T(s.element,r),this._isActive=!1,t&&s._emitter.emit(this._id,!0,s)}destroy(){if(!this.item)return;this.stop(!0,0,0),this.item._emitter.off(this._id),this.animator.destroy();let{style:t}=this.item.element;t[H]="",t.left="",t.top="",this.item=null}_finish(){if(!this.item)return;let{item:t}=this;if(t._translateX=t.left+t._containerDiffX,t._translateY=t.top+t._containerDiffY,this.isActive()){this._isActive=!1;let{itemPositioningClass:e}=t.getGrid().settings;T(t.element,e)}t._dragRelease.isActive()&&t._dragRelease.stop(),t._migrate.isActive()&&t._migrate.stop(),t._emitter.emit(this._id,!1,t)}_setupAnimation(){if(!this.item||!this.isActive())return;let{item:t}=this,{x:e,y:i}=t._getTranslate();this._tX=e,this._tY=i;let s=t.getGrid();s.settings._animationWindowing&&s._layoutNeedsDimensionsRefresh&&(s._layoutNeedsDimensionsRefresh=!1,s._updateBoundingRect(),s._updateBorders(!0,!1,!0,!1))}_startAnimation(){if(!this.item||!this.isActive())return;let{item:t}=this,{settings:e}=t.getGrid(),i=this._duration<=0,s=t.left+t._containerDiffX,r=t.top+t._containerDiffY,a=Math.abs(t.left-(this._tX-t._containerDiffX)),d=Math.abs(t.top-(this._tY-t._containerDiffY));if(i||a<Ui&&d<Ui||e._animationWindowing&&!t._isInViewport(this._tX,this._tY,xt)&&!t._isInViewport(s,r,xt)){(this._isInterrupted||a>.1||d>.1)&&t._setTranslate(s,r),this.animator.stop(),this._finish();return}this._isInterrupted||A(t.element,e.itemPositioningClass),ji[H]=z(this._tX,this._tY,e.translate3d),Qi[H]=z(s,r,e.translate3d),Zt.duration=this._duration,Zt.easing=this._easing,Zt.onFinish=this._finish,t._translateX=t._translateY=void 0,this.animator.start(ji,Qi,Zt),Zt.onFinish=void 0}};var $t=class{constructor(t){this.item=t,this.container=null,this._isActive=!1}isActive(){return this._isActive}start(t,e,i){if(!this.item)return;let s=this.item,r=s.getGrid(),a=s.element,d=s.isActive(),o=s.isVisible(),l=r.settings,c=r.items.indexOf(s),h=t.element,u=t.settings,m=t.items,f=i||document.body,_=0;if(typeof e=="number")_=Q(m,e,1);else{let p=t.getItem(e);if(!p)return;_=m.indexOf(p)}if(s._drag&&s._drag.stop(),this.isActive()||s.isPositioning()||s.isReleasing()){let{x:p,y:E}=s._getTranslate();s.isPositioning()&&s._layout.stop(!0,p,E),p-=s._containerDiffX,E-=s._containerDiffY,this.isActive()?this.stop(!0,p,E):s.isReleasing()&&s._dragRelease.stop(!0,p,E)}if(s._visibility.stop(!0),r._hasListeners(B)&&r._emit(B,{item:s,fromGrid:r,fromIndex:c,toGrid:t,toIndex:_}),t._hasListeners(Lt)&&t._emit(Lt,{item:s,fromGrid:r,fromIndex:c,toGrid:t,toIndex:_}),s.isDestroyed()||r.isDestroyed()||t.isDestroyed())return;s._drag&&(s._drag.destroy(),s._drag=null),l.itemClass!==u.itemClass&&(T(a,l.itemClass),A(a,u.itemClass));let b=o?l.itemVisibleClass:l.itemHiddenClass,S=o?u.itemVisibleClass:u.itemHiddenClass;if(b!==S&&(T(a,b),A(a,S)),r.items.splice(c,1),Pt(m,s,_),s._gridId=t.id,d){let p=a.parentNode;if(f!==p){f.appendChild(a);let E=Z(f,p,!0),L=s._getTranslate();s._setTranslate(L.x+E.left,L.y+E.top)}}else h.appendChild(a);if(s._visibility.setStyles(o?u.visibleStyles:u.hiddenStyles),d){let{left:p,top:E}=Z(f,h,!0);s._containerDiffX=p,s._containerDiffY=E}s._updateDimensions(),s._sortData=null,u.dragEnabled&&(s._drag=new ot(s)),d?(this._isActive=!0,this.container=f):(this._isActive=!1,this.container=null),r._hasListeners(It)&&r._emit(It,{item:s,fromGrid:r,fromIndex:c,toGrid:t,toIndex:_}),t._hasListeners(At)&&t._emit(At,{item:s,fromGrid:r,fromIndex:c,toGrid:t,toIndex:_})}stop(t=!1,e,i){if(!this.item||!this.isActive())return;let{item:s}=this,r=s.getGrid();if(this.container!==r.element){if(e===void 0||i===void 0)if(t){let a=s._getTranslate();e=a.x-s._containerDiffX,i=a.y-s._containerDiffY}else e=s.left,i=s.top;r.element.appendChild(s.element),s._setTranslate(e,i),s._containerDiffX=0,s._containerDiffY=0}this._isActive=!1,this.container=null}destroy(){this.item&&(this.stop(!0),this.item=null)}};function Zi(n,t){let e={},i;if(Array.isArray(t)){let s=0;for(;s<t.length;s++)i=t[s],e[i]=x(n,Ut(i))}else for(i in t)e[i]=x(n,Ut(i));return e}var Jt=class{constructor(t){let e=t.element.children[0];if(!e)throw new Error("No valid child element found within item element.");let i=t.isActive();this.item=t,this.element=e,this.animator=new it(e),this._id=Symbol(),this._isHidden=!i,this._isHiding=!1,this._isShowing=!1,this._currentStyleProps=[],this._finishShow=this._finishShow.bind(this),this._finishHide=this._finishHide.bind(this),t.element.style.display=i?"":"none";let{settings:s}=t.getGrid();A(t.element,i?s.itemVisibleClass:s.itemHiddenClass),this.setStyles(i?s.visibleStyles:s.hiddenStyles)}isHidden(){return this._isHidden}isHiding(){return this._isHiding}isShowing(){return this._isShowing}show(t,e){if(!this.item)return;let{item:i}=this,s=y(e)?e:null;if(!this._isShowing&&!this._isHidden){s&&s(!1,i);return}if(this._isShowing&&!t){s&&i._emitter.once(this._id,s);return}if(!this._isShowing){i._emitter.emit(this._id,!0,i);let{settings:r}=i.getGrid();r&&(T(i.element,r.itemHiddenClass),A(i.element,r.itemVisibleClass)),this._isHiding||(i.element.style.display="")}s&&i._emitter.once(this._id,s),this._isShowing=!0,this._isHiding=this._isHidden=!1,this._startAnimation(!0,t,this._finishShow)}hide(t,e){if(!this.item)return;let{item:i}=this,s=y(e)?e:null;if(!this._isHiding&&this._isHidden){s&&s(!1,i);return}if(this._isHiding&&!t){s&&i._emitter.once(this._id,s);return}if(!this._isHiding){i._emitter.emit(this._id,!0,i);let{settings:r}=i.getGrid();A(i.element,r.itemHiddenClass),T(i.element,r.itemVisibleClass)}s&&i._emitter.once(this._id,s),this._isHidden=this._isHiding=!0,this._isShowing=!1,this._startAnimation(!1,t,this._finishHide)}stop(t){if(!this.item||!this._isHiding&&!this._isShowing)return;let{item:e}=this;g.off(v,this._id),g.off(D,this._id),this.animator.stop(),t&&e._emitter.emit(this._id,!0,e)}setStyles(t){if(!this.element)return;let{element:e,_currentStyleProps:i}=this;this._removeCurrentStyles();let s;for(s in t)i.push(s),e.style[s]=t[s]}destroy(){if(!this.item)return;let{item:t}=this,e=t.element,{settings:i}=t.getGrid();this.stop(!0),t._emitter.off(this._id),this.animator.destroy(),this._removeCurrentStyles(),i&&(T(e,i.itemVisibleClass),T(e,i.itemHiddenClass)),e.style.display="",this._isHiding=this._isShowing=!1,this._isHidden=!0,this.item=null}_startAnimation(t,e,i){if(!this.item||!this.element)return;let{item:s,element:r,animator:a}=this,d=s.getGrid(),{settings:o}=d,l=t?o.visibleStyles:o.hiddenStyles,c=t?o.showDuration:o.hideDuration,h=t?o.showEasing:o.hideEasing,u=e||c<=0;if(!l){a.stop(),i&&i();return}if(g.off(v,this._id),g.off(D,this._id),u){q(r,l),a.stop(),i&&i();return}a.animation&&(a.animation.onfinish=null);let m,f=0,_=0;d._visibilityNeedsDimensionsRefresh=!0,g.once(v,()=>{if(!this.item||(t?!this._isShowing:!this._isHiding))return;m=Zi(r,l);let{x:b,y:S}=s._getTranslate();f=b,_=S,o._animationWindowing&&d._visibilityNeedsDimensionsRefresh&&(d._visibilityNeedsDimensionsRefresh=!1,d._updateBoundingRect(),d._updateBorders(!0,!1,!0,!1))},this._id),g.once(D,()=>{if(!(!this.item||(t?!this._isShowing:!this._isHiding))){if(o._animationWindowing&&!s._isInViewport(f,_,xt)&&(!s.isActive()||!s._isInViewport(s.left+s._containerDiffX,s.top+s._containerDiffY,xt))){q(r,l),a.stop(),i&&i();return}m&&a.start(m,l,{duration:c,easing:h,onFinish:i})}},this._id)}_finishShow(){!this.item||this._isHidden||(this._isShowing=!1,this.item._emitter.emit(this._id,!1,this.item))}_finishHide(){if(!this.item||!this._isHidden)return;let{item:t}=this;this._isHiding=!1,t._layout.stop(!0,0,0),t.element.style.display="none",t._emitter.emit(this._id,!1,t)}_removeCurrentStyles(){if(!this.element)return;let{element:t,_currentStyleProps:e}=this,i=0;for(;i<e.length;i++)t.style[e[i]]="";e.length=0}};var Xs=0;function ve(){return++Xs}var te={width:window.innerWidth,height:window.innerHeight};window.addEventListener("resize",function(){te.width=window.innerWidth,te.height=window.innerHeight});var ee={left:0,top:0,width:0,height:0},ie={left:0,top:0,width:0,height:0};function Ki(n,t,e,i,s){return s=s||0,ee.left=e,ee.top=i,ee.width=n,ee.height=t,ie.left=0-s,ie.top=0-s,ie.width=te.width+s+s,ie.height=te.height+s+s,ue(ee,ie)}var se={x:0,y:0},Ke={left:0,top:0},Ct=class{constructor(t,e,i){let{settings:s,element:r,id:a}=t;if(ht){if(ht.has(e))throw new Error("You can only create one Muuri Item per element!");ht.set(e,this)}this.id=ve(),this.element=e,this.left=0,this.top=0,this.width=0,this.height=0,this.marginLeft=0,this.marginRight=0,this.marginTop=0,this.marginBottom=0,this._gridId=a,this._isDestroyed=!1,this._translateX=void 0,this._translateY=void 0,this._containerDiffX=0,this._containerDiffY=0,this._sortData=null,this._emitter=new st({dedupe:X.THROW}),r&&e.parentNode!==r&&r.appendChild(e),A(e,s.itemClass),typeof i!="boolean"&&(i=x(e,"display")!=="none"),this._isActive=i,this._visibility=new Jt(this),this._layout=new Kt(this),this._migrate=new $t(this),this._drag=s.dragEnabled?new ot(this):null,this._dragRelease=new Qt(this),this._dragPlaceholder=new jt(this)}getGrid(){return dt.get(this._gridId)||null}isActive(){return this._isActive}isVisible(){return!this._visibility.isHidden()}isShowing(){return!!this._visibility.isShowing()}isHiding(){return!!this._visibility.isHiding()}isPositioning(){return!!this._layout.isActive()}isDragging(){var t;return!!((t=this._drag)!=null&&t.isActive())}isReleasing(){return!!this._dragRelease.isActive()}isDestroyed(){return this._isDestroyed}_updateDimensions(t){if(this._isDestroyed||t!==!0&&!this.isVisible()&&!this.isHiding())return;let e=this.element,{width:i,height:s}=e.getBoundingClientRect();this.width=i,this.height=s,this.marginLeft=Math.max(0,C(e,"margin-left")),this.marginRight=Math.max(0,C(e,"margin-right")),this.marginTop=Math.max(0,C(e,"margin-top")),this.marginBottom=Math.max(0,C(e,"margin-bottom")),this._dragPlaceholder.updateDimensions()}_updateSortData(){if(this._isDestroyed)return;let{settings:t}=this.getGrid(),{sortData:e}=t;if(this._sortData={},e){let i;for(i in e)this._sortData[i]=e[i](this,this.element)}}_addToLayout(t=0,e=0){this.isActive()||(this._isActive=!0,this.left=t,this.top=e)}_removeFromLayout(){this.isActive()&&(this._isActive=!1,this.left=0,this.top=0)}_canSkipLayout(t,e){return this.left===t&&this.top===e&&!this._migrate.isActive()&&!this._dragRelease.isActive()&&!this._layout._skipNextAnimation}_setTranslate(t,e){this._translateX===t&&this._translateY===e||(this._translateX=t,this._translateY=e,this.element.style[H]=z(t,e,this.getGrid().settings.translate3d))}_getTranslate(){if(this._translateX===void 0||this._translateY===void 0){let t=kt(this.element);se.x=t.x,se.y=t.y}else se.x=this._translateX,se.y=this._translateY;return se}_getClientRootPosition(){let t=this.getGrid();return Ke.left=t._rect.left+t._borderLeft-this._containerDiffX,Ke.top=t._rect.top+t._borderTop-this._containerDiffY,Ke}_isInViewport(t,e,i=0){let s=this._getClientRootPosition();return Ki(this.width,this.height,s.left+this.marginLeft+t,s.top+this.marginTop+e,i||0)}_destroy(t=!1){var s;if(this._isDestroyed)return;let e=this.element,{settings:i}=this.getGrid();this._dragPlaceholder.destroy(),this._dragRelease.destroy(),this._migrate.destroy(),this._layout.destroy(),this._visibility.destroy(),this._drag&&this._drag.destroy(),this._emitter.off(),T(e,i.itemClass),t&&((s=e.parentNode)==null||s.removeChild(e)),ht&&ht.delete(e),this._isActive=!1,this._isDestroyed=!0}};function De(n=!1){let t={fillGaps:1,horizontal:2,alignRight:4,alignBottom:8,rounding:16},e=.001,i=.5;function s(d){return((d*1e3+.5<<0)/10<<0)/100}class r{constructor(){this._currentRects=[],this._nextRects=[],this._rectStore=[],this._slotSizes=[],this._shards=[],this._rectTarget={left:0,top:0,width:0,height:0},this._tempRectA={left:0,top:0,width:0,height:0},this._tempRectB={left:0,top:0,width:0,height:0},this._rectId=0,this._slotIndex=-1,this._slot={left:0,top:0,width:0,height:0},this._sortRectsLeftTop=this._sortRectsLeftTop.bind(this),this._sortRectsTopLeft=this._sortRectsTopLeft.bind(this)}computeLayout(o,l){let c=o.items;if(!c.length)return o;let h=o.slots,u=!!(l&t.fillGaps),m=!!(l&t.horizontal),f=!!(l&t.alignRight),_=!!(l&t.alignBottom),b=!!(l&t.rounding),S=typeof c[0]=="number",p=S?2:1,E=0,L=0,P=0,I,N;for(E=0;E<c.length;E+=p)S?(L=c[E],P=c[E+1]):(N=c[E],L=N.width+(N.marginLeft||0)+(N.marginRight||0),P=N.height+(N.marginTop||0)+(N.marginBottom||0)),b&&(L=s(L),P=s(P)),I=this._computeNextSlot(o,L,P,u,m),m?I.left+I.width>o.width&&(o.width=I.left+I.width):I.top+I.height>o.height&&(o.height=I.top+I.height),h[++this._slotIndex]=I.left,h[++this._slotIndex]=I.top,(f||_)&&this._slotSizes.push(I.width,I.height);if(f)for(E=0;E<h.length;E+=2)h[E]=o.width-(h[E]+this._slotSizes[E]);if(_)for(E=1;E<h.length;E+=2)h[E]=o.height-(h[E]+this._slotSizes[E]);return this._slotSizes.length=0,this._currentRects.length=0,this._nextRects.length=0,this._shards.length=0,this._rectId=0,this._slotIndex=-1,o}_computeNextSlot(o,l,c,h,u){let{_slot:m,_currentRects:f,_nextRects:_}=this,b=!1,S=!1,p,E,L=0,P=0;for(_.length=0,m.left=0,m.top=0,m.width=l,m.height=c,L=0;L<f.length;L++)if(E=f[L],!!E&&(p=this._getRect(E),m.width<=p.width+e&&m.height<=p.height+e)){S=!0,m.left=p.left,m.top=p.top;break}if(S||(u?(m.left=o.width,m.top=0):(m.left=0,m.top=o.height),h||(b=!0)),!u&&m.top+m.height>o.height+e&&(m.left>i&&_.push(this._addRect(0,o.height,m.left,1/0)),m.left+m.width<o.width-i&&_.push(this._addRect(m.left+m.width,o.height,o.width-m.left-m.width,1/0)),o.height=m.top+m.height),u&&m.left+m.width>o.width+e&&(m.top>i&&_.push(this._addRect(o.width,0,1/0,m.top)),m.top+m.height<o.height-i&&_.push(this._addRect(o.width,m.top+m.height,1/0,o.height-m.top-m.height)),o.width=m.left+m.width),!b)for(h&&(L=0);L<f.length;L++){if(E=f[L],!E)continue;p=this._getRect(E);let I=this._splitRect(p,m);for(P=0;P<I.length;P++)E=I[P],p=this._getRect(E),(u?p.left+e<o.width-e:p.top+e<o.height-e)&&_.push(E)}return _.length>1&&this._purgeRects(_).sort(u?this._sortRectsLeftTop:this._sortRectsTopLeft),this._currentRects=_,this._nextRects=f,m}_addRect(o,l,c,h){let u=++this._rectId;return this._rectStore[u]=o||0,this._rectStore[++this._rectId]=l||0,this._rectStore[++this._rectId]=c||0,this._rectStore[++this._rectId]=h||0,u}_getRect(o,l){return l=l||this._rectTarget,l.left=this._rectStore[o]||0,l.top=this._rectStore[++o]||0,l.width=this._rectStore[++o]||0,l.height=this._rectStore[++o]||0,l}_splitRect(o,l){let{_shards:c}=this,h=0,u=0;return c.length=0,o.left+o.width<=l.left+e||l.left+l.width<=o.left+e||o.top+o.height<=l.top+e||l.top+l.height<=o.top+e?(c.push(this._addRect(o.left,o.top,o.width,o.height)),c):(h=l.left-o.left,h>=i&&c.push(this._addRect(o.left,o.top,h,o.height)),h=o.left+o.width-(l.left+l.width),h>=i&&c.push(this._addRect(l.left+l.width,o.top,h,o.height)),u=l.top-o.top,u>=i&&c.push(this._addRect(o.left,o.top,o.width,u)),u=o.top+o.height-(l.top+l.height),u>=i&&c.push(this._addRect(o.left,l.top+l.height,o.width,u)),c)}_isRectAWithinRectB(o,l){return o.left+e>=l.left&&o.top+e>=l.top&&o.left+o.width-e<=l.left+l.width&&o.top+o.height-e<=l.top+l.height}_purgeRects(o){let{_tempRectA:l,_tempRectB:c}=this,h=o.length,u=0;for(;h--;)if(u=o.length,!!o[h]){for(this._getRect(o[h],l);u--;)if(!(!o[u]||h===u)&&(this._getRect(o[u],c),this._isRectAWithinRectB(l,c))){o[h]=0;break}}return o}_sortRectsTopLeft(o,l){let{_tempRectA:c,_tempRectB:h}=this;return this._getRect(o,c),this._getRect(l,h),c.top<h.top&&c.top+e<h.top?-1:c.top>h.top&&c.top-e>h.top?1:c.left<h.left&&c.left+e<h.left?-1:c.left>h.left&&c.left-e>h.left?1:0}_sortRectsLeftTop(o,l){let{_tempRectA:c,_tempRectB:h}=this;return this._getRect(o,c),this._getRect(l,h),c.left<h.left&&c.left+e<h.left?-1:c.left>h.left&&c.left-e<h.left?1:c.top<h.top&&c.top+e<h.top?-1:c.top>h.top&&c.top-e>h.top?1:0}}let a=new r;if(n){let d=self,o=1,l=2,c=3,h=4;d.onmessage=function(u){let m=new Float32Array(u.data),f=m.subarray(h,m.length),_=new Float32Array(f.length),b=m[c],S={items:f,slots:_,width:m[o],height:m[l]};a.computeLayout(S,b),m[o]=S.width,m[l]=S.height,m.set(S.slots,h),d.postMessage(m.buffer,[m.buffer])}}return a}var Mt="",$e=new Set;function $i(n,t){let e=[];if(n>0){Mt||(Mt=URL.createObjectURL(new Blob(["("+De.toString()+")(true)"],{type:"application/javascript"})));let i=0;for(;i<n;i++){let s=new Worker(Mt);s.onmessage=t,e.push(s),$e.add(s)}}return e}function Ji(n){let t=0;for(;t<n.length;t++){let e=n[t];e.onmessage=null,e.onerror=null,e.onmessageerror=null,e.terminate(),$e.delete(e)}Mt&&!$e.size&&(URL.revokeObjectURL(Mt),Mt="")}var V={fillGaps:1,horizontal:2,alignRight:4,alignBottom:8,rounding:16},K={id:0,width:1,height:2,settings:3,slots:4},Ys=De(),ne=class{constructor(t=0,e){this._settings=0,this._asyncMode=!0,this._workers=[],this._layoutWorkerQueue=[],this._layoutsProcessing=new Set,this._layoutWorkerData=new Map,this._onWorkerMessage=this._onWorkerMessage.bind(this),e&&this.updateSettings(e);try{this._workers=$i(t,this._onWorkerMessage),this._asyncMode=!!this._workers.length}catch(i){}}updateSettings(t){let e=this._settings&V.fillGaps;typeof t.fillGaps=="boolean"&&(e=t.fillGaps?V.fillGaps:0);let i=this._settings&V.horizontal;typeof t.horizontal=="boolean"&&(i=t.horizontal?V.horizontal:0);let s=this._settings&V.alignRight;typeof t.alignRight=="boolean"&&(s=t.alignRight?V.alignRight:0);let r=this._settings&V.alignBottom;typeof t.alignBottom=="boolean"&&(r=t.alignBottom?V.alignBottom:0);let a=this._settings&V.rounding;typeof t.rounding=="boolean"&&(a=t.rounding?V.rounding:0),this._settings=e|i|s|r|a}createLayout(t,e,i,s){if(this._layoutWorkerData.has(t))throw new Error("A layout with the provided id is currently being processed.");let r=!this._asyncMode||!e.length,a=this._settings&V.horizontal,d={id:t,items:e,slots:new Float32Array(r?e.length*2:0),width:a?0:i.width,height:a?i.height:0,styles:{}};if(r){e.length&&Ys.computeLayout(d,this._settings),this._setContainerStyles(d,i,this._settings),s(d);return}let o=new Float32Array(K.slots+e.length*2);o[K.id]=t,o[K.width]=d.width,o[K.height]=d.height,o[K.settings]=this._settings;let l=0,c=K.slots-1;for(;l<e.length;l++){let h=e[l];o[++c]=h.width+(h.marginLeft||0)+(h.marginRight||0),o[++c]=h.height+(h.marginTop||0)+(h.marginBottom||0)}return this._layoutWorkerQueue.push(t),this._layoutWorkerData.set(t,de(M({},d),{container:i,settings:this._settings,callback:s,packet:o,aborted:!1})),this._sendToWorker(),this.cancelLayout.bind(this,t)}cancelLayout(t){let e=this._layoutWorkerData.get(t);if(!(!e||e.aborted))if(e.worker)e.aborted=!0;else{let i=this._layoutWorkerQueue.indexOf(t);this._layoutWorkerQueue.splice(i,1),this._layoutWorkerData.delete(t)}}destroy(){this._layoutWorkerData.forEach(t=>{this.cancelLayout(t.id),t.worker&&this._workers.push(t.worker)}),this._layoutWorkerData.clear(),this._layoutsProcessing.clear(),this._layoutWorkerQueue.length=0,Ji(this._workers),this._workers.length=0}_sendToWorker(){if(!this._layoutWorkerQueue.length||!this._workers.length)return;let t=this._workers.pop(),e=this._layoutWorkerQueue.shift(),i=this._layoutWorkerData.get(e);i.worker=t,this._layoutsProcessing.add(e);let{buffer:s}=i.packet;t.postMessage(s,[s])}_onWorkerMessage(t){let e=new Float32Array(t.data),i=e[K.id],s=this._layoutWorkerData.get(i);if(this._layoutWorkerData.delete(i),this._layoutsProcessing.delete(i),!s)return;let{worker:r}=s;if(r&&this._workers.push(r),!s.aborted){let a={id:i,items:s.items,slots:e.subarray(K.slots,e.length),width:e[K.width],height:e[K.height],styles:{}};this._setContainerStyles(a,s.container,s.settings),s.callback(a)}r&&this._sendToWorker()}_setContainerStyles(t,e,i){let s=!!(i&V.horizontal),r=e.boxSizing==="border-box",{borderLeft:a=0,borderRight:d=0,borderTop:o=0,borderBottom:l=0}=e,{styles:c,width:h,height:u}=t;s?c.width=(r?h+a+d:h)+"px":c.height=(r?u+o+l:u)+"px"}};function ts(n,t){let e=Symbol(),i=0,s=0,r=!1,a=d=>{r||(s&&(i-=d-s),s=d,i>0?a&&g.once(v,a,e):(i=s=0,n()))};return function(o=!1){if(!r){if(t<=0){o!==!0&&n();return}if(o===!0){r=!0,i=s=0,a=void 0,g.off(v,e);return}i<=0?(i=t,a&&a(0)):i=t}}}var Ws="[object HTMLCollection]",Vs="[object NodeList]";function re(n){let t=Object.prototype.toString.call(n);return t===Ws||t===Vs}var Fs=Object.prototype.toString;function Je(n){return typeof n=="object"&&Fs.call(n)==="[object Object]"}function es(n){return re(n)?Array.prototype.slice.call(n):Array.prototype.concat(n)}var is=0;function ss(n,t={}){let e=oe({},n);return e=oe(e,t),t.visibleStyles?e.visibleStyles=M({},t.visibleStyles):n.visibleStyles&&(e.visibleStyles=M({},n.visibleStyles)),t.hiddenStyles?e.hiddenStyles=M({},t.hiddenStyles):n.hiddenStyles&&(e.hiddenStyles=M({},n.hiddenStyles)),e}function oe(n,t){let e=Object.keys(t),i=e.length,s=0;for(;s<i;s++){let r=e[s],a=Je(t[r]);if(Je(n[r])&&a){n[r]=oe(oe({},n[r]),t[r]);continue}if(a){n[r]=oe({},t[r]);continue}if(Array.isArray(t[r])){n[r]=t[r].slice(0);continue}n[r]=t[r]}return n}function qs(n,t){if(t==="*")return n.children;if(typeof t=="string"){let e=[],i=n.children,s=0;for(;s<i.length;s++)i[s].matches(t)&&e.push(i[s]);return e}return Array.isArray(t)||re(t)?t:[]}function Te(n){let t={},e=document.documentElement.style,i,s;for(i in n)n[i]&&(s=ft(e,i),s&&(t[s]=n[i]));return t}function Ie(n,t){let e;for(e in n)if(n[e]!==t[e])return!1;return Object.keys(n).length===Object.keys(t).length}var pt=class pt{constructor(t,e={}){if(typeof t=="string"){let s=document.querySelector(t);if(!s)throw new Error("No container element found.");t=s}if(!t.isConnected||t===document.documentElement)throw new Error("Container element must be an existing DOM element.");let i=ss(pt.defaultOptions,e);i.visibleStyles=Te(i.visibleStyles),i.hiddenStyles=Te(i.hiddenStyles),this.id=ve(),this.element=t,this.settings=i,this.items=[],this._isDestroyed=!1,this._layoutNeedsDimensionsRefresh=!1,this._visibilityNeedsDimensionsRefresh=!1,this._rect={width:0,height:0,left:0,right:0,top:0,bottom:0},this._borderLeft=0,this._borderRight=0,this._borderTop=0,this._borderBottom=0,this._boxSizing="",this._layout={id:0,items:[],slots:[]},this._isLayoutFinished=!0,this._nextLayoutData=null,this._resizeHandler=null,this._emitter=new st({dedupe:X.THROW}),dt.set(this.id,this),A(t,i.containerClass),this._bindLayoutOnResize(i.layoutOnResize),this.add(qs(t,i.items),{layout:!1}),i.layoutOnInit&&this.layout(!0)}on(t,e,i){return this._emitter.on(t,e,i)}once(t,e,i){return this._emitter.once(t,e,i)}off(t,e){return this._emitter.off(t,e)}isDestroyed(){return this._isDestroyed}getItem(t){if(this._isDestroyed||!t&&t!==0)return null;if(typeof t=="number")return this.items[t>-1?t:this.items.length+t]||null;if(t instanceof Ct)return t._gridId===this.id?t:null;let e=ht.get(t);return e&&e._gridId===this.id?e:null}getItems(t){if(this._isDestroyed||t===void 0)return this.items.slice(0);let e=[];if(Array.isArray(t)||re(t)){let i,s=0;for(;s<t.length;s++)i=this.getItem(t[s]),i&&e.push(i)}else{let i=this.getItem(t);i&&e.push(i)}return e}updateSettings(t){if(this._isDestroyed||!t)return this;let{settings:e,items:i}=this,s=[],r=!1,a=!1,d=!1,o=!1,l=!1,c=!1,h=ss(e,t);h.visibleStyles=Te(h.visibleStyles),h.hiddenStyles=Te(h.hiddenStyles),this.settings=h;for(let u in t)switch(u){case"visibleStyles":{l=!Ie(e[u],h[u]);break}case"hiddenStyles":{c=!Ie(e[u],h[u]);break}case"dragEnabled":{r=e[u]!==h[u];break}case"dragHandle":{a=e[u]!==h[u];break}case"dragCssProps":{d=!Ie(e[u],h[u]);break}case"dragEventListenerOptions":{o=!Ie(e[u],h[u]);break}case"layoutOnResize":{e[u]!==h[u]&&(this._unbindLayoutOnResize(),this._bindLayoutOnResize(h[u]));break}case"containerClass":{e[u]!==h[u]&&(T(this.element,e[u]),A(this.element,h[u]));break}case"itemClass":case"itemVisibleClass":case"itemHiddenClass":case"itemPositioningClass":case"itemDraggingClass":case"itemReleasingClass":case"itemPlaceholderClass":{e[u]!==h[u]&&s.push(u,e[u],h[u]);break}}if(s.length||l||c||r||a||d||o){let u,m;for(u=0;u<i.length;u++){let f=i[u];for(m=0;m<s.length;m+=3){let _=s[m],b=s[m+1],S=s[m+2],p=!1;switch(_){case"itemClass":{p=!0;break}case"itemVisibleClass":{p=f.isVisible();break}case"itemHiddenClass":{p=!f.isVisible();break}case"itemPositioningClass":{p=f.isPositioning();break}case"itemDraggingClass":{p=f.isDragging();break}case"itemReleasingClass":{p=f.isReleasing();break}case"itemPlaceholderClass":{f._dragPlaceholder.updateClassName(S);break}}p&&(T(f.element,b),A(f.element,S))}f.isActive()?l&&(f._visibility.setStyles(h.visibleStyles),f._visibility.stop(!0)):c&&(f._visibility.setStyles(h.hiddenStyles),f._visibility.stop(!0)),(a||r)&&f._drag&&f._drag.getOriginGrid()===this&&(f._drag.destroy(),f._drag=null),h.dragEnabled&&(f._drag?f._drag.getOriginGrid()===this&&(d&&f._drag.dragger.setCssProps(h.dragCssProps),o&&f._drag.dragger.setListenerOptions(h.dragEventListenerOptions)):f._drag=new ot(f))}}return"sortData"in t&&this.refreshSortData(),this}refreshItems(t,e=!1){if(this._isDestroyed)return this;let i=t||this.items,s,r,a,d;if(e===!0)for(d=[],s=0;s<i.length;s++)r=i[s],!r.isVisible()&&!r.isHiding()&&(a=r.element.style,a.visibility="hidden",a.display="",d.push(a));for(s=0;s<i.length;s++)i[s]._updateDimensions(e);if(d){for(s=0;s<d.length;s++)a=d[s],a.visibility="",a.display="none";d.length=0}return this}refreshSortData(t){if(this._isDestroyed)return this;let e=t||this.items,i=0;for(;i<e.length;i++)e[i]._updateSortData();return this}synchronize(){if(this._isDestroyed)return this;let{items:t}=this;if(!t.length)return this;let e,i,s=0;for(;s<t.length;s++)i=t[s].element,i.parentNode===this.element&&(e||(e=document.createDocumentFragment()),e.appendChild(i));return e?(this.element.appendChild(e),this._emit(gi),this):this}layout(t=!1,e){if(this._isDestroyed)return this;let i=this._nextLayoutData;i&&y(i.cancel)&&i.cancel();let s=is=is%Ci+1;this._nextLayoutData={id:s,instant:t,onFinish:e,cancel:null};let{items:r}=this,a=[],d=0;for(;d<r.length;d++)r[d].isActive()&&a.push(r[d]);this._updateDimensions();let o={width:this._rect.width-this._borderLeft-this._borderRight,height:this._rect.height-this._borderTop-this._borderBottom,borderLeft:this._borderLeft,borderRight:this._borderRight,borderTop:this._borderTop,borderBottom:this._borderBottom,boxSizing:this._boxSizing},{layout:l}=this.settings,c;return y(l)?c=l(s,this,a,o,h=>{this._onLayoutDataReceived(h)}):(pt.defaultPacker.updateSettings(l),c=pt.defaultPacker.createLayout(s,a,o,h=>{this._onLayoutDataReceived(de(M({},h),{items:a}))})),y(c)&&this._nextLayoutData&&this._nextLayoutData.id===s&&(this._nextLayoutData.cancel=c),this}add(t,e={}){if(this._isDestroyed||!t)return[];let i=es(t);if(!i.length)return[];let s=e.layout?e.layout:e.layout===void 0,{items:r}=this,a=!1,d,o,l,c;for(c=0;c<i.length;c++)o=i[c],o.parentNode!==this.element&&(d=d||document.createDocumentFragment(),d.appendChild(o));d&&this.element.appendChild(d);let h=[];for(c=0;c<i.length;c++)o=i[c],l=h[c]=new Ct(this,o,e.active),l.isActive()&&(a=!0,l._layout._skipNextAnimation=!0);for(c=0;c<h.length;c++)l=h[c],l._updateDimensions(),l._updateSortData();return Pt(r,h,e.index),this._hasListeners(We)&&this._emit(We,h.slice(0)),a&&s&&this.layout(s===rt,y(s)?s:void 0),h}remove(t,e={}){if(this._isDestroyed||!t.length)return[];let i=e.layout?e.layout:e.layout===void 0,s=this.getItems(),r=[],a=[],d=!1,o,l,c;for(c=0;c<t.length;c++)l=t[c],!l.isDestroyed()&&(o=this.items.indexOf(l),o!==-1&&(l.isActive()&&(d=!0),r.push(l),a.push(s.indexOf(l)),l._destroy(e.removeElements),this.items.splice(o,1)));return this._hasListeners(Ve)&&this._emit(Ve,r.slice(0),a),d&&i&&this.layout(i===rt,y(i)?i:void 0),r}show(t,e={}){return!this._isDestroyed&&t.length&&this._setItemsVisibility(t,!0,e),this}hide(t,e={}){return!this._isDestroyed&&t.length&&this._setItemsVisibility(t,!1,e),this}filter(t,e={}){if(this._isDestroyed||!this.items.length)return this;let i=[],s=[];if(y(t)||typeof t=="string"){let l,c;for(c=0;c<this.items.length;c++)l=this.items[c],(y(t)?t(l):l.element.matches(t))?i.push(l):s.push(l)}let r=y(e.onFinish)?e.onFinish:void 0,a=[],d=[],o=-1;if(i.length?this.show(i,{instant:!!e.instant,syncWithLayout:!!e.syncWithLayout,onFinish:r?l=>{a=l,++o&&r(a,d)}:void 0,layout:!1}):r&&++o&&r(a,d),s.length?this.hide(s,{instant:!!e.instant,syncWithLayout:!!e.syncWithLayout,onFinish:r?l=>{d=l,++o&&r(a,d)}:void 0,layout:!1}):r&&++o&&r(a,d),i.length||s.length){this._hasListeners(Fe)&&this._emit(Fe,i.slice(0),s.slice(0));let l=e.layout?e.layout:e.layout===void 0;l&&this.layout(l===rt,y(l)?l:void 0)}return this}sort(t,e={}){if(this._isDestroyed||this.items.length<2)return this;let{items:i}=this,s=i.slice(0),r=e.layout?e.layout:e.layout===void 0,a=!!e.descending;if(y(t))i.sort((d,o)=>a?-t(d,o):t(d,o));else if(typeof t=="string"){let d=t.trim().split(" ").filter(function(o){return o}).map(function(o){return o.split(":")});i.sort((o,l)=>{let c=0,h=0;for(;h<d.length;h++){let u=d[h][0],m=d[h][1];o._sortData===null&&o._updateSortData(),l._sortData===null&&l._updateSortData();let f=o._sortData[u],_=l._sortData[u];if(m==="desc"||!m&&a?c=_<f?-1:_>f?1:0:c=f<_?-1:f>_?1:0,c)return c}return c})}else if(Array.isArray(t))i.length=0,i.push.apply(i,t);else throw new Error("Invalid comparer argument provided.");return this._hasListeners(qe)&&this._emit(qe,i.slice(0),s),r&&this.layout(r===rt,y(r)?r:void 0),this}move(t,e,i={}){if(this._isDestroyed||this.items.length<2)return this;let{items:s}=this,r=i.layout?i.layout:i.layout===void 0,a=i.action===Y,d=a?Y:nt,o=this.getItem(t),l=this.getItem(e);if(o&&l&&o!==l){let c=s.indexOf(o),h=s.indexOf(l);a?ye(s,c,h):pe(s,c,h),this._hasListeners(Tt)&&this._emit(Tt,{item:o,fromIndex:c,toIndex:h,action:d}),r&&this.layout(r===rt,y(r)?r:void 0)}return this}send(t,e,i,s={}){if(this._isDestroyed||e._isDestroyed||this===e)return this;let r=this.getItem(t);if(!r)return this;if(r._migrate.start(e,i,s.appendTo||document.body),r._migrate.isActive()&&r.isActive()){let a=s.layoutSender?s.layoutSender:s.layoutSender===void 0,d=s.layoutReceiver?s.layoutReceiver:s.layoutReceiver===void 0;a&&this.layout(a===rt,y(a)?a:void 0),d&&e.layout(d===rt,y(d)?d:void 0)}return this}destroy(t=!1){if(this._isDestroyed)return this;let e=this.element,i=this.getItems(),s=this._layout&&this._layout.styles||{};this._unbindLayoutOnResize();let r=0;for(;r<i.length;r++)i[r]._destroy(t);this.items.length=0,T(e,this.settings.containerClass);let a;for(a in s)e.style[a]="";return dt.delete(this.id),this._isDestroyed=!0,this._emitter.emit(Ai),this._emitter.off(),this}_emit(t,...e){this._isDestroyed||this._emitter.emit(t,...e)}_hasListeners(t){return this._isDestroyed?!1:this._emitter.listenerCount(t)>0}_updateBoundingRect(){let{_rect:t}=this,{width:e,height:i,left:s,right:r,top:a,bottom:d}=this.element.getBoundingClientRect();t.width=e,t.height=i,t.left=s,t.right=r,t.top=a,t.bottom=d}_updateBorders(t,e,i,s){let{element:r}=this;t&&(this._borderLeft=C(r,"border-left-width")),e&&(this._borderRight=C(r,"border-right-width")),i&&(this._borderTop=C(r,"border-top-width")),s&&(this._borderBottom=C(r,"border-bottom-width"))}_updateDimensions(){this._updateBoundingRect(),this._updateBorders(!0,!0,!0,!0),this._boxSizing=x(this.element,"box-sizing")}_bindLayoutOnResize(t){typeof t!="number"&&(t=t===!0?0:-1),t>=0&&(this._resizeHandler=ts(()=>{this.refreshItems().layout()},t),window.addEventListener("resize",this._resizeHandler))}_unbindLayoutOnResize(){let{_resizeHandler:t}=this;y(t)&&(t(!0),window.removeEventListener("resize",this._resizeHandler),this._resizeHandler=null)}_onLayoutDataReceived(t){if(this._isDestroyed||!this._nextLayoutData||this._nextLayoutData.id!==t.id)return;let{instant:e,onFinish:i}=this._nextLayoutData,s=t.items.length,r=s,a,d,o,l;this._nextLayoutData=null,!this._isLayoutFinished&&this._hasListeners(Ye)&&this._emit(Ye,this._layout.items.slice(0)),this._layout=t;let c=[];for(l=0;l<s;l++){if(a=t.items[l],!a){--r;continue}if(d=t.slots[l*2],o=t.slots[l*2+1],a._canSkipLayout(d,o)){--r;continue}a.left=d,a.top=o,a.isActive()&&!a.isDragging()?c.push(a):--r}if(t.styles&&q(this.element,t.styles),this._hasListeners(j)&&(this._emit(j,t.items.slice(0),e),this._layout.id!==t.id))return;let h=()=>{if(--r>0)return;let u=this._layout.id!==t.id;u||(this._isLayoutFinished=!0),y(i)&&i(t.items.slice(0),u),!u&&this._hasListeners(Xe)&&this._emit(Xe,t.items.slice(0))};if(!c.length){h();return}for(this._isLayoutFinished=!1,l=0;l<c.length&&this._layout.id===t.id;l++)c[l]._layout.start(e,h)}_setItemsVisibility(t,e,i={}){let s=t.slice(0),r=i.instant===!0,a=i.onFinish,d=i.layout?i.layout:i.layout===void 0,o=e?pi:mt,l=e?yi:Ei,c=e?"show":"hide",h=[],u=[],m=!1,f=s.length,_,b;if(!f){y(a)&&a(s);return}for(b=0;b<s.length;b++)_=s[b],(e&&!_.isActive()||!e&&_.isActive())&&(m=!0),_._layout._skipNextAnimation=!!(e&&!_.isActive()),e&&!_.isVisible()&&!_.isHiding()&&u.push(_),e?_._addToLayout():_._removeFromLayout();u.length&&(this.refreshItems(u,!0),u.length=0);let S=()=>{for(m&&i.syncWithLayout!==!1&&this.off(j,S),this._hasListeners(o)&&this._emit(o,s.slice(0)),b=0;b<s.length;b++){if(_=s[b],_._gridId!==this.id){--f<1&&(y(a)&&a(h.slice(0)),this._hasListeners(l)&&this._emit(l,h.slice(0)));continue}_._visibility[c](r,(p,E)=>{p||h.push(E),--f<1&&(y(a)&&a(h.slice(0)),this._hasListeners(l)&&this._emit(l,h.slice(0)))})}};m&&i.syncWithLayout!==!1?this.on(j,S,S):S(),m&&d&&this.layout(d===rt,y(d)?d:void 0)}};pt.defaultPacker=new ne,pt.defaultOptions={items:"*",showDuration:300,showEasing:"ease",hideDuration:300,hideEasing:"ease",visibleStyles:{opacity:"1",transform:"scale(1)"},hiddenStyles:{opacity:"0",transform:"scale(0.5)"},layout:{fillGaps:!1,horizontal:!1,alignRight:!1,alignBottom:!1,rounding:!1},layoutOnResize:150,layoutOnInit:!0,layoutDuration:300,layoutEasing:"ease",sortData:null,translate3d:!1,dragEnabled:!1,dragContainer:null,dragHandle:null,dragStartPredicate:{distance:0,delay:0},dragAxis:"xy",dragSort:!0,dragSortHeuristics:{sortInterval:100,minDragDistance:10,minBounceBackAngle:1},dragSortPredicate:{threshold:50,action:nt,migrateAction:nt},dragRelease:{duration:300,easing:"ease",useDragContainer:!0},dragCssProps:{touchAction:"none",userSelect:"none",userDrag:"none",tapHighlightColor:"rgba(0, 0, 0, 0)",touchCallout:"none",contentZooming:"none"},dragEventListenerOptions:{passive:!0,capture:!1},dragPlaceholder:{enabled:!1,createElement:null,onCreate:null,onRemove:null},dragAutoScroll:{targets:[],handle:null,threshold:50,safeZone:.2,speed:O.smoothSpeed(1e3,2e3,2500),sortDuringScroll:!0,smoothStop:!1,onStart:null,onStop:null},containerClass:"muuri",itemClass:"muuri-item",itemVisibleClass:"muuri-item-shown",itemHiddenClass:"muuri-item-hidden",itemPositioningClass:"muuri-item-positioning",itemDraggingClass:"muuri-item-dragging",itemReleasingClass:"muuri-item-releasing",itemPlaceholderClass:"muuri-item-placeholder",_animationWindowing:!1};var ti=pt;

try{module.exports = exports.default ?? module.exports ?? exports;}catch(e){ console.log("Could not export module:", e);}

